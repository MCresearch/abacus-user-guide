
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Introduction to ABACUS: Path to PW calculation - Part 3 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-image-captions/image-captions.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-insert-logo/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-intopic-toc/style.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="develop-path4.html" />
    
    
    <link rel="prev" href="develop-path2.html" />
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"buttons":[{"user":"MCresearch","repo":"abacus-user-guide","type":"star","size":"middle","count":true}]};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    ABACUS 使用教程
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="abacus-gcc.html">
            
                <a href="abacus-gcc.html">
            
                    
                    GCC 编译 ABACUS 教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="abacus-intel.html">
            
                <a href="abacus-intel.html">
            
                    
                    Intel oneAPI 编译 ABACUS 教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="abacus-gpu.html">
            
                <a href="abacus-gpu.html">
            
                    
                    编译 Nvidia GPU 版本的 ABACUS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="abacus-hpc.html">
            
                <a href="abacus-hpc.html">
            
                    
                    在超算环境编译 ABACUS 的建议
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.5" data-path="abacus-dcu.html">
            
                <a href="abacus-dcu.html">
            
                    
                    ABACUS 在曙光 DCU 集群上的编译与使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.6" data-path="abacus-question.html">
            
                <a href="abacus-question.html">
            
                    
                    ABACUS 答疑手册
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.7" data-path="abacus-conv.html">
            
                <a href="abacus-conv.html">
            
                    
                    ABACUS 收敛性问题解决手册
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.8" data-path="abacus-upf.html">
            
                <a href="abacus-upf.html">
            
                    
                    模守恒赝势生成方法简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.9" data-path="abacus-nac1.html">
            
                <a href="abacus-nac1.html">
            
                    
                    数值原子轨道（一）：ABACUS 中的数值原子轨道命名和使用方法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.10" data-path="abacus-nac2.html">
            
                <a href="abacus-nac2.html">
            
                    
                    数值原子轨道（二）：生成给定模守恒赝势的数值原子轨道
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.11" data-path="abacus-nac3.html">
            
                <a href="abacus-nac3.html">
            
                    
                    数值原子轨道（三）：产生高精度数值原子轨道
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.12" data-path="abacus-pw.html">
            
                <a href="abacus-pw.html">
            
                    
                    ABACUS 的平面波计算与收敛性测试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.13" data-path="abacus-md.html">
            
                <a href="abacus-md.html">
            
                    
                    ABACUS 分子动力学使用教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.14" data-path="abacus-sol.html">
            
                <a href="abacus-sol.html">
            
                    
                    ABACUS 隐式溶剂模型使用教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.15" data-path="abacus-sdft.html">
            
                <a href="abacus-sdft.html">
            
                    
                    ABACUS 随机波函数DFT方法使用教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.16" data-path="abacus-ofdft.html">
            
                <a href="abacus-ofdft.html">
            
                    
                    ABACUS 无轨道密度泛函理论方法使用教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.17" data-path="abacus-surface1.html">
            
                <a href="abacus-surface1.html">
            
                    
                    采用 ABACUS 进行表面计算（一）：静电势和功函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.18" data-path="abacus-surface2.html">
            
                <a href="abacus-surface2.html">
            
                    
                    采用 ABACUS 进行表面计算（二）：偶极修正
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.19" data-path="abacus-surface3.html">
            
                <a href="abacus-surface3.html">
            
                    
                    采用 ABACUS 进行表面计算（三）：表面能计算
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.20" data-path="abacus-surface4.html">
            
                <a href="abacus-surface4.html">
            
                    
                    采用 ABACUS 进行表面计算（四）：表面缺陷能和吸附能计算
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.21" data-path="abacus-surface5.html">
            
                <a href="abacus-surface5.html">
            
                    
                    采用 ABACUS 进行表面计算（五）：外加电场
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.22" data-path="abacus-surface6.html">
            
                <a href="abacus-surface6.html">
            
                    
                    采用 ABACUS 进行表面计算（六）：补偿电荷
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.23" data-path="abacus-dos.html">
            
                <a href="abacus-dos.html">
            
                    
                    ABACUS+Atomkit 计算态密度和能带
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.24" data-path="abacus-phonopy.html">
            
                <a href="abacus-phonopy.html">
            
                    
                    ABACUS+Phonopy 计算声子谱
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.25" data-path="abacus-shengbte.html">
            
                <a href="abacus-shengbte.html">
            
                    
                    ABACUS+ShengBTE 计算晶格热导率
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.26" data-path="abacus-dpgen.html">
            
                <a href="abacus-dpgen.html">
            
                    
                    ABACUS+DPGEN 使用教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.27" data-path="abacus-libri.html">
            
                <a href="abacus-libri.html">
            
                    
                    ABACUS+LibRI 做杂化泛函计算教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.28" data-path="abacus-candela.html">
            
                <a href="abacus-candela.html">
            
                    
                    ABACUS+Candela 使用教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.29" data-path="abacus-uspex.html">
            
                <a href="abacus-uspex.html">
            
                    
                    ABACUS+USPEX 接口教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.30" data-path="abacus-namd.html">
            
                <a href="abacus-namd.html">
            
                    
                    ABACUS+Hefei NAMD 使用教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.31" data-path="abacus-wannier.html">
            
                <a href="abacus-wannier.html">
            
                    
                    ABACUS+Wannier90 使用教程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    ABACUS 开发者文档
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="develop-C++.html">
            
                <a href="develop-C++.html">
            
                    
                    ABACUS 开源项目 C++ 代码规范
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="develop-format.html">
            
                <a href="develop-format.html">
            
                    
                    ABACUS 中使用格式化工具 clang-format
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="develop-dox.html">
            
                <a href="develop-dox.html">
            
                    
                    ABACUS 注释规范：Doxygen 入门 (c++)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="develop-issue.html">
            
                <a href="develop-issue.html">
            
                    
                    ABACUS 的 Github 仓库 Issues 处理流程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="develop-input.html">
            
                <a href="develop-input.html">
            
                    
                    ABACUS 线上文档输入参数撰写规范
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="develop-rule.html">
            
                <a href="develop-rule.html">
            
                    
                    ABACUS 代码存放规范
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="develop-linedete.html">
            
                <a href="develop-linedete.html">
            
                    
                    ABACUS 全局数据结构和代码行数检测
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="develop-test1.html">
            
                <a href="develop-test1.html">
            
                    
                    ABACUS 中的测试（一）：测试的重要性
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="develop-test2.html">
            
                <a href="develop-test2.html">
            
                    
                    ABACUS 中的测试（二）：测试工具 gtest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="develop-path1.html">
            
                <a href="develop-path1.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="develop-path2.html">
            
                <a href="develop-path2.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 2
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.12" data-path="develop-path3.html">
            
                <a href="develop-path3.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13" data-path="develop-path4.html">
            
                <a href="develop-path4.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.14" data-path="develop-path5.html">
            
                <a href="develop-path5.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.15" data-path="develop-sm1.html">
            
                <a href="develop-sm1.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Summary 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.16" data-path="develop-path6.html">
            
                <a href="develop-path6.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.17" data-path="develop-path7.html">
            
                <a href="develop-path7.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.18" data-path="develop-path8.html">
            
                <a href="develop-path8.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 8
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.19" data-path="develop-path9.html">
            
                <a href="develop-path9.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.20" data-path="develop-path10.html">
            
                <a href="develop-path10.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 10
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.21" data-path="develop-path11.html">
            
                <a href="develop-path11.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Part 11
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.22" data-path="develop-sm2.html">
            
                <a href="develop-sm2.html">
            
                    
                    Introduction to ABACUS: Path to PW calculation - Summary Final
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.23" data-path="develop-addinp.html">
            
                <a href="develop-addinp.html">
            
                    
                    如何在 ABACUS 中新增一个输入参数（截至 v3.5.3）
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.24" data-path="develop-design.html">
            
                <a href="develop-design.html">
            
                    
                    C++ 程序设计的一些想法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    算法文档
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="algorithm-wannier.html">
            
                <a href="algorithm-wannier.html">
            
                    
                    最大局域化 Wannier 函数方法简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="algorithm-mix.html">
            
                <a href="algorithm-mix.html">
            
                    
                    电荷密度混合算法介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="algorithm-delta.html">
            
                <a href="algorithm-delta.html">
            
                    
                    在 ABACUS 中进行差分测试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="news.html">
            
                <a href="news.html">
            
                    
                    ABACUS 新闻稿整理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="contribute.html">
            
                <a href="contribute.html">
            
                    
                    如何贡献 ABACUS 使用教程
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Introduction to ABACUS: Path to PW calculation - Part 3</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="introduction-to-abacus-path-to-pw-calculation---part-3"><a name="introduction-to-abacus-path-to-pw-calculation---part-3" class="plugin-anchor" href="#introduction-to-abacus-path-to-pw-calculation---part-3"><i class="fa fa-link" aria-hidden="true"></i></a>Introduction to ABACUS: Path to PW calculation - Part 3</h1>
<p><strong>&#x4F5C;&#x8005;&#xFF1A;&#x9EC4;&#x4E00;&#x73C2;&#xFF0C;&#x90AE;&#x7BB1;&#xFF1A;huangyk@aisi.ac.cn</strong></p>
<p><strong>&#x5BA1;&#x6838;&#xFF1A;&#x9648;&#x9ED8;&#x6DB5;&#xFF0C;&#x90AE;&#x7BB1;&#xFF1A;mohanchen@pku.edu.cn</strong></p>
<p><strong>&#x98DE;&#x4E66;&#x94FE;&#x63A5;&#xFF1A;<a href="https://xmywuqhxb0.feishu.cn/docx/LUFZdHVQxoWhsRxytfhcWWDYnib" target="_blank">Introduction to ABACUS: Path to PW calculation - Part 3</a></strong></p>
<blockquote>
<p>&#x1F4C3;<strong>&#x5199;&#x5728;&#x524D;&#x9762;</strong></p>
<ol>
<li>&#x4E0D;&#x8131;&#x79BB;&#x4EE3;&#x7801;&#x2014;&#x2014;&#x907F;&#x514D;&#x8BFB;&#x8005;&#x770B;&#x5B8C;&#x624B;&#x518C;&#x540E;&#x5BF9;&#x4EE3;&#x7801;&#x6CA1;&#x6709;&#x4E00;&#x4E01;&#x70B9;&#x6982;&#x5FF5;</li>
<li>&#x4E0D;&#x5806;&#x780C;&#x4EE3;&#x7801;&#x89E3;&#x91CA;&#x2014;&#x2014;&#x907F;&#x514D;&#x5E73;&#x5EB8;&#x7684;&#x4EE3;&#x7801;&#x89E3;&#x91CA;&#xFF0C;&#x52AA;&#x529B;&#x517C;&#x987E;&#x62C9;&#x8FD1;&#x8BFB;&#x8005;&#x548C;&#x4EE3;&#x7801;&#x8DDD;&#x79BB;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x505A;&#x5230;&#x63D0;&#x7EB2;&#x6308;&#x9886;&#xFF0C;&#x4E0D;&#x9010;&#x884C;&#x590D;&#x5236;&#x4EE3;&#x7801;&#x540E;&#x8FDB;&#x884C;&#x505C;&#x7559;&#x5728;&#x4EE3;&#x7801;&#x8BED;&#x4E49;&#x4E0A;&#x7684;&#x89E3;&#x91CA;</li>
</ol>
</blockquote>
<p><strong>Driver</strong></p>
<p><strong>Driver::atomic_world()</strong></p>
<p><strong>Driver::driver_run()</strong></p>
<h1 id="&#x591A;&#x5C42;&#x7EE7;&#x627F;&#xFF1A;init-functions-in-esolver-class"><a name="&#x591A;&#x5C42;&#x7EE7;&#x627F;&#xFF1A;init-functions-in-esolver-class" class="plugin-anchor" href="#&#x591A;&#x5C42;&#x7EE7;&#x627F;&#xFF1A;init-functions-in-esolver-class"><i class="fa fa-link" aria-hidden="true"></i></a>&#x591A;&#x5C42;&#x7EE7;&#x627F;&#xFF1A;Init() functions in esolver class</h1>
<h2 id="trigger-esolverfpinit"><a name="trigger-esolverfpinit" class="plugin-anchor" href="#trigger-esolverfpinit"><i class="fa fa-link" aria-hidden="true"></i></a>Trigger: ESolver_FP::Init()</h2>
<p>&#x627F;&#x63A5;&#x4E0A;&#x7BC7;&#x4E2D;&#x5DF2;&#x7ECF;&#x5BFC;&#x5165;&#x7684;&#x7ED3;&#x6784;&#x4FE1;&#x606F;&#xFF0C;&#x4EE5;&#x53CA;&#x4E86;&#x89E3;&#x5230;&#x6784;&#x9020;&#x51FD;&#x6570;&#x53CA;&#x5176;&#x4F34;&#x968F;&#x7684;&#x53D8;&#x91CF;&#x521D;&#x59CB;&#x5316;&#x548C; ABACUS &#x91CC;&#x5E94;&#x7528;&#x5230;&#x7684; C++ &#x591A;&#x6001;&#x7F16;&#x7A0B;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x5373;&#x5C06;&#xFF08;&#x9010;&#x6E10;&#xFF09;&#x6B65;&#x5165; ABACUS &#x7684;&#x6838;&#x5FC3;&#x5185;&#x5BB9;&#x3002;&#x6211;&#x4EEC;&#x6682;&#x65F6;&#x8DF3;&#x8FC7;&#x4F4D;&#x4E8E; <code>source/driver_run.cpp:driver_run()</code> &#x7684;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp"><span class="token comment">// 3. For these two types of calculations</span>
    <span class="token comment">// nothing else need to be initialized</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>GlobalV<span class="token double-colon punctuation">::</span>CALCULATION <span class="token operator">==</span> <span class="token string">&quot;test_neighbour&quot;</span> <span class="token operator">||</span> GlobalV<span class="token double-colon punctuation">::</span>CALCULATION <span class="token operator">==</span> <span class="token string">&quot;test_memory&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        p_esolver<span class="token operator">-&gt;</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> GlobalC<span class="token double-colon punctuation">::</span>ucell<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ModuleBase</span><span class="token double-colon punctuation">::</span><span class="token function">QUIT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>&#x76F4;&#x63A5;&#x6765;&#x5230;&#x7B2C; 44 &#x884C;&#xFF0C;<code>ModuleESolver::ESolver::Init()</code> &#x51FD;&#x6570;&#x5BF9; <code>esolver</code> &#x8FDB;&#x884C;&#x66F4;&#x591A;&#x7684;&#x8BBE;&#x7F6E;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp"><span class="token comment">// driver_run.cpp: line 44</span>
    p_esolver<span class="token operator">-&gt;</span><span class="token function">Init</span><span class="token punctuation">(</span>INPUT<span class="token punctuation">,</span> GlobalC<span class="token double-colon punctuation">::</span>ucell<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>&#x7136;&#x800C;&#x67E5;&#x627E;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x5B9A;&#x4E49;&#x548C;&#x58F0;&#x660E;&#x65F6;&#xFF0C;&#x53D1;&#x73B0;&#x8BE5;&#x51FD;&#x6570;&#x5728; <code>module_esolver/esolver.h</code> &#x88AB;&#x58F0;&#x660E;&#x4E3A;&#x7EAF;&#x865A;&#x51FD;&#x6570;&#xFF0C;&#x7C7B;&#x4F3C;&#x7684;&#x8FD8;&#x6709; <code>un()</code>, <code>cal_Energy()</code>, <code>cal_Force()</code>, <code>cal_Stress()</code> &#x7B49;&#x3002;</p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">namespace</span> ModuleESolver
<span class="token punctuation">{</span>
<span class="token keyword">class</span> <span class="token class-name">ESolver</span>
<span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span>Input<span class="token operator">&amp;</span> inp<span class="token punctuation">,</span> UnitCell<span class="token operator">&amp;</span> cell<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">int</span> istep<span class="token punctuation">,</span> UnitCell<span class="token operator">&amp;</span> cell<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">cal_Force</span><span class="token punctuation">(</span>ModuleBase<span class="token double-colon punctuation">::</span>matrix<span class="token operator">&amp;</span> force<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">cal_Stress</span><span class="token punctuation">(</span>ModuleBase<span class="token double-colon punctuation">::</span>matrix<span class="token operator">&amp;</span> stress<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>&#x8003;&#x8651;&#x5230;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x5DF2;&#x7ECF;&#x6839;&#x636E; <code>basis_type</code> &#x548C; <code>esolver_type</code> &#x786E;&#x5B9A;&#x57FA;&#x7C7B;&#xFF08;<code>ESolver</code>&#xFF09;&#x6307;&#x9488; <code>p_esolver</code> &#x6240;&#x6307;&#x5411;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x6240;&#x5B58;&#x50A8;&#x53D8;&#x91CF;&#x4E3A; <code>ESolver_KS_PW<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>double,</span> <span class="token attr-name"><span class="token namespace">psi:</span>:DEVICE_CPU</span><span class="token punctuation">&gt;</span></span></code>&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x9996;&#x5148;&#x53EA;&#x5173;&#x6CE8;&#x8BE5;&#x7EAF;&#x865A;&#x51FD;&#x6570;&#x5728; <code>esolver_ks_pw</code> &#x7684;&#x5B9E;&#x4F8B;&#x5316;&#x3002;</p>
<p>&#x67E5;&#x770B; <code>module_esolver/esolver_ks_pw.cpp</code> &#x4E2D;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x5B9A;&#x4E49;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">namespace</span> ModuleESolver
<span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">FPTYPE</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">Device</span><span class="token operator">&gt;</span>
    <span class="token keyword">void</span> <span class="token class-name">ESolver_KS_PW</span><span class="token operator">&lt;</span>FPTYPE<span class="token punctuation">,</span> Device<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span>Input<span class="token operator">&amp;</span> inp<span class="token punctuation">,</span> UnitCell<span class="token operator">&amp;</span> ucell<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">ESolver_KS</span><span class="token operator">&lt;</span>FPTYPE<span class="token punctuation">,</span> Device<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span>inp<span class="token punctuation">,</span> ucell<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>&#x4ECE;&#x4E0A;&#x7BC7;&#x4E2D;&#x53EF;&#x77E5;&#xFF0C;<code>ESolver_KS_PW</code> &#x6709;&#x4ECE; <code>ESolver_KS</code> &#x7684;&#x7EE7;&#x627F;&#xFF0C;<code>ESolver_KS</code> &#x662F;&#x4ECE; <code>ESolver_FP</code>&#xFF08;FP &#x4EE3;&#x8868; First-Principles&#xFF09;&#x7684;&#x7EE7;&#x627F;&#xFF0C;<code>ESolver_FP</code> &#x662F;&#x4ECE; <code>ESolver</code> &#x7684;&#x7EE7;&#x627F;&#xFF0C;&#x56E0;&#x6B64; <code>ESolver</code> &#x5404;&#x5B50;&#x7C7B;&#x4E2D; <code>Init()</code> &#x51FD;&#x6570;&#x5747;&#x4FDD;&#x6301;&#x7ED3;&#x6784;&#x7EDF;&#x4E00;&#xFF0C;&#x4E14;&#x7B2C;&#x4E00;&#x884C;&#x4E3A;&#x7236;&#x7C7B;&#x7684; <code>Init()</code> &#x51FD;&#x6570;&#xFF1A;</p>
<p><code>module_esolver/esolver_ks.cpp</code>&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">namespace</span> ModuleESolver
<span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">FPTYPE</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">Device</span><span class="token operator">&gt;</span>
    <span class="token keyword">void</span> <span class="token class-name">ESolver_KS</span><span class="token operator">&lt;</span>FPTYPE<span class="token punctuation">,</span> Device<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span>Input<span class="token operator">&amp;</span> inp<span class="token punctuation">,</span> UnitCell<span class="token operator">&amp;</span> ucell<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">ESolver_FP</span><span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span>inp<span class="token punctuation">,</span>ucell<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><code>module_esolver/esolver_fp.cpp</code>&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">namespace</span> ModuleESolver
<span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">void</span> <span class="token class-name">ESolver_FP</span><span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span>Input<span class="token operator">&amp;</span> inp<span class="token punctuation">,</span> UnitCell<span class="token operator">&amp;</span> cell<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cell<span class="token punctuation">.</span><span class="token function">read_pseudo</span><span class="token punctuation">(</span>GlobalV<span class="token double-colon punctuation">::</span>ofs_running<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>&#x540C;&#x65F6;&#x7531;&#x4E8E;&#x591A;&#x5C42;&#x7684;&#x7EE7;&#x627F;&#x5173;&#x7CFB;&#xFF0C;<code>p_esolver</code> &#x73B0;&#x5728;&#x5177;&#x6709;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x6210;&#x5458;&#xFF0C;<code>ESolver_FP</code> &#x5177;&#x6709;&#x6570;&#x636E;&#x6210;&#x5458;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">namespace</span> ModuleESolver
<span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">ESolver_FP</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">ESolver</span></span>
    <span class="token punctuation">{</span>
    <span class="token keyword">public</span><span class="token operator">:</span>
        ModulePW<span class="token double-colon punctuation">::</span>PW_Basis<span class="token operator">*</span> pw_rho<span class="token punctuation">;</span>
        ModulePW<span class="token double-colon punctuation">::</span>PW_Basis_Big<span class="token operator">*</span> pw_big<span class="token punctuation">;</span>

        elecstate<span class="token double-colon punctuation">::</span>ElecState<span class="token operator">*</span> pelec <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
        Charge chr<span class="token punctuation">;</span>
        ModuleSymmetry<span class="token double-colon punctuation">::</span>Symmetry symm<span class="token punctuation">;</span>

        psi<span class="token double-colon punctuation">::</span>Psi<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>complex<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;&gt;</span><span class="token operator">*</span> psi <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
        psi<span class="token double-colon punctuation">::</span>Psi<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token operator">*</span> psid <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
        Structure_Factor sf<span class="token punctuation">;</span>
        K_Vectors kv<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x540C;&#x7406;&#xFF0C;<code>ESolver_KS</code> &#x7684;&#x6570;&#x636E;&#x6210;&#x5458;&#xFF0C;&#x4E5F;&#x88AB; <code>ESolver_KS_PW</code> &#x7EE7;&#x627F;&#x3002;<code>ESolver_FP::Init()</code> &#x9996;&#x5148;&#x8C03;&#x7528; <code>UnitCell::read_pseudo()</code> &#x51FD;&#x6570;&#x8FDB;&#x884C;&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#xFF0C;&#x800C;&#x5C06;&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x4EFB;&#x52A1;&#x653E;&#x5728; FP &#x5C42;&#x7EA7;&#x4E0B;&#xFF0C;&#x4E5F;&#x6697;&#x793A;&#x5BF9;&#x4E8E; ABACUS &#x7684;&#x7B2C;&#x4E00;&#x6027;&#x539F;&#x7406;&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;&#x6765;&#x8BB2;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x8D5D;&#x52BF;&#x3002;</p>
<h3 id="pseudopotential-import-unitcellreadpseudo"><a name="pseudopotential-import-unitcellreadpseudo" class="plugin-anchor" href="#pseudopotential-import-unitcellreadpseudo"><i class="fa fa-link" aria-hidden="true"></i></a>Pseudopotential import: UnitCell::read_pseudo()</h3>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">void</span> <span class="token class-name">UnitCell</span><span class="token double-colon punctuation">::</span><span class="token function">read_pseudo</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>ofstream <span class="token operator">&amp;</span>ofs<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">read_cell_pseudopots</span><span class="token punctuation">(</span>GlobalV<span class="token double-colon punctuation">::</span>global_pseudo_dir<span class="token punctuation">,</span> ofs<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>&#x5728;&#x89E3;&#x8BFB;&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x529F;&#x80FD;&#x4E4B;&#x524D;&#xFF0C;&#x9996;&#x5148;&#x9700;&#x8981;&#x5BF9;&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x7684;&#x7ED3;&#x6784;&#x548C;&#x4FE1;&#x606F;&#x505A;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x7684;&#x4E86;&#x89E3;&#x3002;</p>
<h4 id="oncv-pseudopotential-file"><a name="oncv-pseudopotential-file" class="plugin-anchor" href="#oncv-pseudopotential-file"><i class="fa fa-link" aria-hidden="true"></i></a>ONCV pseudopotential file</h4>
<h5 id="section-0-norm-conserving-conditions-generation-of-pseudopotential-and-header-of-exact-upf-file"><a name="section-0-norm-conserving-conditions-generation-of-pseudopotential-and-header-of-exact-upf-file" class="plugin-anchor" href="#section-0-norm-conserving-conditions-generation-of-pseudopotential-and-header-of-exact-upf-file"><i class="fa fa-link" aria-hidden="true"></i></a>Section 0: Norm-conserving conditions, generation of pseudopotential and header of exact UPF file</h5>
<p>&#x8D5D;&#x52BF;&#x7684;&#x610F;&#x4E49;&#x4E0D;&#x8A00;&#x81EA;&#x660E;&#xFF0C;&#x5176;&#x4E2D;&#x6A21;&#x5B88;&#x6052;&#x8D5D;&#x52BF;&#x9700;&#x6EE1;&#x8DB3;&#x5982;&#x4E0B;&#x6761;&#x4EF6;&#xFF1A;</p>
<ol>
<li><script type="math/tex; ">\epsilon^\text{ps}_l=\epsilon_l</script>&#xFF08;&#x8D5D;&#x52BF;&#x5F97;&#x5230;&#x7684;&#x80FD;&#x7EA7;&#x548C;&#x5168;&#x7535;&#x5B50;&#x65B9;&#x6CD5;&#x6C42;&#x89E3;&#x7684;&#x80FD;&#x7EA7;&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x91CC; ps &#x4EE3;&#x8868; pseudopotentials&#xFF09;</li>
<li><script type="math/tex; ">\phi^\text{ps}_l(r)</script>&#x65E0;&#x8282;&#x70B9;&#xFF08;&#x8D5D;&#x6CE2;&#x51FD;&#x6570;&#x6CA1;&#x6709;&#x7ED3;&#x70B9;&#xFF0C;nodeless&#xFF09;</li>
<li>&#x5728;&#x622A;&#x65AD;&#x534A;&#x5F84;&#x4E4B;&#x5916;&#xFF08;<script type="math/tex; ">r>r_c</script>&#xFF09;&#x6709;<script type="math/tex; ">\phi^\text{ps}_l(r)=\phi_l(r)</script>&#xFF08;&#x8D5D;&#x6CE2;&#x51FD;&#x6570;&#x5728;&#x622A;&#x65AD;&#x534A;&#x5F84;&#x4E4B;&#x540E;&#x4E00;&#x81F4;&#xFF09;</li>
<li><script type="math/tex; ">\int_{r<r_c}|\phi^\text{ps}_l(r)|^2r^2dr=\int_{r<r_c}|\phi_l(r)|^2r^2dr</script>&#xFF08;&#x7535;&#x5B50;&#x6570;&#x5B88;&#x6052;&#xFF0C;&#x5373;&#x6A21;&#x5B88;&#x6052;&#xFF09;</li>
</ol>
<p>&#x751F;&#x6210;&#x8D5D;&#x52BF;&#x7684;&#x6B65;&#x9AA4;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li><script type="math/tex; ">-\frac{\hbar^2}{2m}\frac{d^2}{dr^2}\phi_{l}(r)+[\frac{\hbar^2}{2m}\frac{l(l+1)}{r^2}+V(r)]\phi_l(r)=\epsilon_l\phi_l(r)</script>&#xFF0C;&#x89E3;&#x5F97;(<script type="math/tex; ">\phi_l(r)</script>-<script type="math/tex; ">\epsilon_l</script>) pair</li>
<li>&#x6EE1;&#x8DB3;&#x4E0A;&#x8FF0;&#x56DB;&#x4E2A;&#x6A21;&#x5B88;&#x6052;&#x6761;&#x4EF6;&#x524D;&#x63D0;&#x4E0B;&#x751F;&#x6210;(<script type="math/tex; ">\phi^\text{ps}_l(r)</script>-<script type="math/tex; ">\epsilon^\text{ps}_l</script>) pair&#xFF0C;&#x4F7F;&#x5F97;<script type="math/tex; ">-\frac{\hbar^2}{2m}\frac{d^2}{dr^2}\phi^\text{ps}_{l}(r)+[\frac{\hbar^2}{2m}\frac{l(l+1)}{r^2}+V(r)]\phi^\text{ps}_l(r)=\epsilon^\text{ps}_l\phi^\text{ps}_l(r)</script>&#x6210;&#x7ACB;</li>
<li><script type="math/tex; ">V_l(r)=\frac{1}{\phi^\text{ps}_l(r)}[\epsilon^\text{ps}_l-\frac{\hbar^2}{2m}\frac{l(l+1)}{r^2}+\frac{\hbar^2}{2m}\frac{d^2}{dr^2}]\phi^\text{ps}_l(r)</script>&#xFF0C;&#x89E3;&#x5F97;<script type="math/tex; ">V_l(r)</script>&#x3002;</li>
<li>&#x6263;&#x9664;<script type="math/tex; ">V_l(r)</script>&#x4E2D; Hartree&#x3001;xc &#x90E8;&#x5206;&#xFF0C;&#x5F97;&#x5230;<script type="math/tex; ">V^\text{ps}_l(r)</script>&#xFF1A;<script type="math/tex; ">V^\text{ps}_l(r)=V_l(r)-V^\text{H}[\rho^\text{ps}(r)]-V^\text{xc}[\rho^\text{ps}(r)]</script>&#x3002;<script type="math/tex; ">\rho^\text{ps}(r)=\frac{1}{4\pi}\sum_i^\text{occ}{f_{i}|\phi^\text{ps}_l(r)|^2}</script></li>
</ol>
<p>&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x89C1;&#xFF1A;<a href="https://www.tcm.phy.cam.ac.uk/~jry20/gipaw/tutorial_pp.pdf" target="_blank">www.tcm.phy.cam.ac.uk</a></p>
<pre class="language-"><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>UPF</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.0.1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_INFO</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- omitted information here --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_INPUTFILE</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- omitted information here --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_INPUTFILE</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_INFO</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--                               --&gt;</span>
    <span class="token comment">&lt;!-- END OF HUMAN READABLE SECTION --&gt;</span>
    <span class="token comment">&lt;!--                               --&gt;</span>
</code></pre>
<p>&#x4ECE; UPF &#x6587;&#x4EF6;&#xFF08;&#x6CE8;&#x610F; UPF &#x6587;&#x4EF6;&#x4E5F;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x7248;&#x672C;&#xFF0C;&#x76EE;&#x524D; ABACUS &#x90FD;&#x652F;&#x6301;&#xFF0C;&#x82E5;&#x6709;&#x4E0D;&#x652F;&#x6301;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x63D0; Github &#x7684; issues &#x8FDB;&#x884C;&#x8BA8;&#x8BBA;&#xFF09;&#x5F00;&#x59CB;&#xFF0C;&#x622A;&#x6B62;&#x5230; <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_HEADER</span><span class="token punctuation">&gt;</span></span></code> &#x4E4B;&#x524D;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x7684;&#x4F5C;&#x8005;&#x4FE1;&#x606F;&#xFF0C;&#x5F15;&#x7528;&#x4FE1;&#x606F;&#x4EE5;&#x53CA;&#x751F;&#x6210;&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x7A0B;&#x5E8F;&#x548C;&#x76F8;&#x5E94;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x9644;&#x5E26;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x53C2;&#x6570;&#x4E2D;&#x7684;&#x89E3;&#x91CA;&#x3002;&#x7531;&#x4E8E;&#x6B64;&#x5757;&#x5185;&#x5BB9;&#x5BF9;&#x5B9E;&#x9645;&#x8BA1;&#x7B97;&#x5E76;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#xFF0C;&#x56E0;&#x6B64;&#x6682;&#x65F6;&#x7565;&#x8FC7;&#x3002;</p>
<h5 id="section-1-"><a name="section-1-" class="plugin-anchor" href="#section-1-"><i class="fa fa-link" aria-hidden="true"></i></a>Section 1: <pp_header></pp_header></h5>
<pre class="language-"><code class="lang-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_HEADER</span>
      <span class="token attr-name">generated</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Generated using ONCVPSP code by D. R. Hamann<span class="token punctuation">&quot;</span></span> <span class="token attr-name">author</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Martin Schlipf and Francois Gygi<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">date</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>150105<span class="token punctuation">&quot;</span></span> <span class="token attr-name">comment</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">element</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Al<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">pseudo_type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>NC<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">relativistic</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scalar<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">is_ultrasoft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>F<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">is_paw</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>F<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">is_coulomb</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>F<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">has_so</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>F<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">has_wfc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>F<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">has_gipaw</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>F<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">core_correction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>F<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">functional</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>PBE<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">z_valence</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>   11.00<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">total_psenergy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>  -6.90690753360E+01<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">rho_cutoff</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>   6.01000000000E+00<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">l_max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">l_local</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-1<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">mesh_size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>   602<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">number_of_wfc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">number_of_proj</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre>
<p><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_HEADER</span><span class="token punctuation">&gt;</span></span></code> &#x90E8;&#x5206;&#x5C3D;&#x7BA1;&#x5DF2;&#x7ECF;&#x4F4D;&#x4E8E;&#x6240;&#x8C13;&#x201C;not human readable&#x201D;&#x533A;&#x57DF;&#xFF0C;&#x4F46;&#x4E5F;&#x5E76;&#x975E;&#x5982;&#x6B64;&#x3002;&#x8FD9;&#x90E8;&#x5206;&#x201C;&#x6807;&#x7B7E;&#x201D;&#xFF08;HTML &#x8BED;&#x5883;&#xFF09;/block &#x5B9E;&#x9645;&#x4E0A;&#x5305;&#x542B;&#x4E86;&#x4F17;&#x591A;&#x7CBE;&#x7B80;&#x8FC7;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x5143;&#x7D20;&#x540D;&#x79F0;&#xFF08;element&#xFF09;&#x3001;&#x8D5D;&#x52BF;&#x7C7B;&#x578B;&#xFF08;pseudo_type&#xFF0C;&#x6A21;&#x5B88;&#x6052;&#xFF0C;norm-conserving&#xFF0C;NC&#xFF09;&#xFF0C;&#x76F8;&#x5BF9;&#x8BBA;&#x6548;&#x5E94;&#xFF08;relativistic&#xFF09;&#xFF0C;&#x662F;&#x5426;&#x4E3A;&#x8D85;&#x8F6F;&#x8D5D;&#x52BF;&#x7B49;&#x7B49;&#x4FE1;&#x606F;&#x3002;&#x5F53;&#x524D; Al &#x7406;&#x8BBA;&#x4E0A;&#x5176;&#x539F;&#x5B50;&#x5E8F;&#x6570; 13&#xFF0C;&#x56E0;&#x6B64;&#x6709; 13 &#x4E2A;&#x7535;&#x5B50;&#xFF0C;&#x4F46;&#x6B64;&#x5904; z_valence &#x53C2;&#x6570;&#x4E3A; 11&#xFF0C;&#x5373;&#x6709;&#x4E24;&#x4E2A; 1s &#x7535;&#x5B50;&#x88AB;&#x8D5D;&#x5316;&#xFF0C;&#x53EA;&#x7559;&#x4E0B; 2s, 2p, 3s, 3p &#x7535;&#x5B50;&#x5171; 2+6+2+1 &#x4E2A;&#x3002;&#x5BF9;&#x4E8E;&#x67D0;&#x4E9B;&#x5143;&#x7D20;&#xFF0C;&#x751A;&#x81F3;&#x6709;&#x5927;&#x6838;&#x8D5D;&#x52BF;&#x4E0E;&#x5C0F;&#x6838;&#x8D5D;&#x52BF;&#x4E4B;&#x5206;&#xFF0C;&#x6839;&#x636E;&#x8D5D;&#x5316;&#x7535;&#x5B50;&#x6570;&#x91CF;&#x4E0D;&#x540C;&#x8FDB;&#x884C;&#x533A;&#x5206;&#x3002;&#x663E;&#x800C;&#x6613;&#x89C1;&#x5730;&#xFF0C;&#x8D5D;&#x5316;&#x7535;&#x5B50;&#x6570;&#x91CF;&#x8D8A;&#x591A;&#xFF0C;&#x5219;&#x8BA1;&#x7B97;&#x91CF;&#x8D8A;&#x5C0F;&#xFF0C;&#x4F46;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;&#x7684;&#x7CBE;&#x786E;&#x7A0B;&#x5EA6;&#x53EF;&#x80FD;&#x66F4;&#x4F4E;&#x3002;</p>
<h5 id="section-2-"><a name="section-2-" class="plugin-anchor" href="#section-2-"><i class="fa fa-link" aria-hidden="true"></i></a>Section 2: <pp_mesh></pp_mesh></h5>
<pre class="language-"><code class="lang-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_MESH</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_R</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>real<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 602<span class="token punctuation">&quot;</span></span> <span class="token attr-name">columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            0.0000    0.0100    0.0200    0.0300    0.0400    0.0500    0.0600    0.0700
            <span class="token comment">&lt;!-- omitted information here --&gt;</span>
            5.9200    5.9300    5.9400    5.9500    5.9600    5.9700    5.9800    5.9900
            6.0000    6.0100
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_R</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_RAB</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>real<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 602<span class="token punctuation">&quot;</span></span> <span class="token attr-name">columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            0.0100    0.0100    0.0100    0.0100    0.0100    0.0100    0.0100    0.0100
            <span class="token comment">&lt;!-- omitted information here --&gt;</span>
            0.0100    0.0100    0.0100    0.0100    0.0100    0.0100    0.0100    0.0100
            0.0100    0.0100
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_RAB</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_MESH</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>&#x8FD9;&#x90E8;&#x5206;&#x5F00;&#x59CB;&#x51FA;&#x73B0;&#x4E86;&#x5173;&#x4E8E;&#x5B9E;&#x7A7A;&#x95F4;&#x683C;&#x70B9;&#x76F8;&#x5173;&#x91CF;&#x7684;&#x5B9A;&#x4E49;&#x3002;&#x5728; tag &#x4E2D;&#x4E0D;&#x4EC5;&#x6307;&#x5B9A;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x4E3A;&#x5B9E;&#x6570;&#xFF0C;&#x4E5F;&#x6307;&#x5B9A;&#x5F53;&#x524D;&#x6570;&#x636E;&#x7684;&#x957F;&#x5EA6;&#xFF08;size&#xFF09;&#xFF0C;&#x4EE5;&#x53CA;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x7684;&#x5217;&#x6570;&#xFF08;columns = 8&#xFF09;&#x3002;<code>PP_R</code> &#x4E3A;&#x683C;&#x70B9;&#x5750;&#x6807;&#xFF0C;<code>PP_RAB</code> &#x5219;&#x4E3A;&#x683C;&#x70B9;&#x95F4;&#x8DDD;&#x3002;</p>
<h5 id="section-3-"><a name="section-3-" class="plugin-anchor" href="#section-3-"><i class="fa fa-link" aria-hidden="true"></i></a>Section 3: <pp_local></pp_local></h5>
<pre class="language-"><code class="lang-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_LOCAL</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>real<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 602<span class="token punctuation">&quot;</span></span> <span class="token attr-name">columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        -4.5793174225E+01   -4.5788454271E+01   -4.5774276797E+01   -4.5750659428E+01
        <span class="token comment">&lt;!-- omitted information here --&gt;</span>
        -3.6912752197E+00   -3.6850921941E+00   -3.6789298138E+00   -3.6727880140E+00
        -3.6666666933E+00   -3.6605657501E+00
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_LOCAL</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>&#x4ECE; <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_LOCAL</span><span class="token punctuation">&gt;</span></span></code> &#x90E8;&#x5206;&#x5F00;&#x59CB;&#xFF0C;&#x6B63;&#x5F0F;&#x5F00;&#x59CB;&#x5199;&#x5165;&#x8D5D;&#x52BF;&#x7684;&#x5177;&#x4F53;&#x6570;&#x503C;&#xFF0C;&#x5EFA;&#x7ACB;&#x5728; <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_R</span><span class="token punctuation">&gt;</span></span></code> &#x548C; <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_RAB</span><span class="token punctuation">&gt;</span></span></code> &#x6240;&#x63CF;&#x8FF0;&#x7684;&#x5B9E;&#x7A7A;&#x95F4;&#x683C;&#x70B9;&#x4E0A;&#x3002;<script type="math/tex; ">\hat{V}=\hat{V}^\text{loc}+\hat{V}^\text{NL}</script>&#x3002;<code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_LOCAL</span><span class="token punctuation">&gt;</span></span></code> &#x6B63;&#x662F;&#x8D5D;&#x52BF;&#x7684;&#x5C40;&#x57DF;&#x52BF;&#x90E8;&#x5206;&#x3002;</p>
<p><img src="picture/fig_path3-1.png" alt=""></p>
<h5 id="section-4-"><a name="section-4-" class="plugin-anchor" href="#section-4-"><i class="fa fa-link" aria-hidden="true"></i></a>Section 4: <pp_nonlocal></pp_nonlocal></h5>
<pre class="language-"><code class="lang-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_NONLOCAL</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_BETA.1</span>
           <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>real<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 602<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">angular_momentum</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">cutoff_radius_index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 246<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">cutoff_radius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>    2.4500000000E+00<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
            0.0000000000E+00    8.1959788337E-02    1.6389680452E-01    2.4578292762E-01
            <span class="token comment">&lt;!-- omitted information here --&gt;</span>
            -1.2623857798E-05    0.0000000000E+00    0.0000000000E+00    0.0000000000E+00
            <span class="token comment">&lt;!-- omitted information here --&gt;</span>
            0.0000000000E+00    0.0000000000E+00    0.0000000000E+00    0.0000000000E+00
            0.0000000000E+00    0.0000000000E+00
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_BETA.1</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_BETA.2</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>real<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 602<span class="token punctuation">&quot;</span></span> <span class="token attr-name">columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">angular_momentum</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">cutoff_radius_index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 246<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cutoff_radius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>    2.4500000000E+00<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
           <span class="token comment">&lt;!-- omitted information here --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_BETA.2</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_BETA.3</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>real<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 602<span class="token punctuation">&quot;</span></span> <span class="token attr-name">columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">angular_momentum</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">cutoff_radius_index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 246<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cutoff_radius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>    2.4500000000E+00<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
           <span class="token comment">&lt;!-- omitted information here --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_BETA.3</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_BETA.4</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>real<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 602<span class="token punctuation">&quot;</span></span> <span class="token attr-name">columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">angular_momentum</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">cutoff_radius_index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 246<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cutoff_radius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>    2.4500000000E+00<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- omitted information here --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_BETA.4</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_DIJ</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>real<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>  16<span class="token punctuation">&quot;</span></span> <span class="token attr-name">columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            5.3707838603E+00    0.0000000000E+00    0.0000000000E+00    0.0000000000E+00
            0.0000000000E+00   -8.2930195943E-01    0.0000000000E+00    0.0000000000E+00
            0.0000000000E+00    0.0000000000E+00   -6.5836757852E+00    0.0000000000E+00
            0.0000000000E+00    0.0000000000E+00    0.0000000000E+00   -4.6797927123E+00
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_DIJ</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_NONLOCAL</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>&#x5B8C;&#x5168;&#x975E;&#x5C40;&#x57DF;&#x90E8;&#x5206;&#xFF0C;<script type="math/tex; ">\hat{V}^\text{NL}=\sum_{ij}{|\beta_i\rangle D_{ij}\langle\beta_j|}</script>&#x3002;&#x5176;&#x4E2D;<script type="math/tex; ">|\beta_i\rangle</script>&#x4E00;&#x822C;&#x88AB;&#x79F0;&#x4E3A;&#x975E;&#x5C40;&#x57DF;&#x52BF;&#x6295;&#x5F71;&#x5B50;&#xFF08;projector&#xFF09;&#x3002;</p>
<p><img src="picture/fig_path3-2.png" alt=""></p>
<h5 id="section-5--and-"><a name="section-5--and-" class="plugin-anchor" href="#section-5--and-"><i class="fa fa-link" aria-hidden="true"></i></a>Section 5: <pp_pswfc> and <pp_rhoatom></pp_rhoatom></pp_pswfc></h5>
<pre class="language-"><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_PSWFC</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_PSWFC</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_RHOATOM</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>real<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> 602<span class="token punctuation">&quot;</span></span> <span class="token attr-name">columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        0.0000000000E+00    3.6337392512E-03    1.4532726686E-02    3.2690254089E-02
        <span class="token comment">&lt;!-- omitted information here --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PP_RHOATOM</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>UPF</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_PSWFC</span><span class="token punctuation">&gt;</span></span></code> &#x4E3A;&#x8D5D;&#x6CE2;&#x51FD;&#x6570;&#xFF0C;<code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_RHOATOM</span><span class="token punctuation">&gt;</span></span></code> &#x5219;&#x4E3A;&#x8D5D;&#x7535;&#x8377;&#x5BC6;&#x5EA6;&#x5728;&#x5B9E;&#x7A7A;&#x95F4;&#x683C;&#x70B9;&#x4E0A;&#x7684;&#x6570;&#x636E;&#x3002;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#x63D0;&#x53D6;&#x811A;&#x672C;&#xFF1A;</p>
<p><a href="https://gitee.com/mcresearch/abacus-user-guide/blob/master/examples/develop/ParseUpfWordByWord.py" target="_blank">ParseUpfWordByWord.py</a></p>
<blockquote>
<p>&#x1F914; &#x73A9;&#x73A9;&#x770B;&#xFF01;</p>
</blockquote>
<p>Quantum ESPRESSO &#x5B98;&#x7F51;&#x4E0A;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x591A;&#x5173;&#x4E8E; UPF &#x6587;&#x4EF6;&#x683C;&#x5F0F;&#x7684;&#x4FE1;&#x606F;&#xFF1A;<a href="https://pseudopotentials.quantum-espresso.org/home/unified-pseudopotential-format" target="_blank">Unified Pseudopotential Format - QUANTUMESPRESSO</a></p>
<blockquote>
<p>&#x2757;<strong>&#x6CE8;&#x610F;</strong>
&#x8BFB;&#x5165;&#x7684;&#x6295;&#x5F71;&#x5B50; projector <script type="math/tex; ">|\beta\rangle</script>&#x548C; pswfc <script type="math/tex; ">\tilde{\phi}(r)</script>&#x5DF2;&#x7ECF;&#x4E58;&#x5F84;&#x5411;&#x5750;&#x6807;<script type="math/tex; ">r</script>&#x3002;</p>
</blockquote>
<h4 id="unitcellreadcellpseudopots"><a name="unitcellreadcellpseudopots" class="plugin-anchor" href="#unitcellreadcellpseudopots"><i class="fa fa-link" aria-hidden="true"></i></a>UnitCell::read_cell_pseudopots()</h4>
<p>link to Github -&gt; <a href="https://github.com/abacusmodeling/abacus-develop/blob/develop/source/module_cell/read_cell_pseudopots.cpp" target="_blank">link</a></p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">void</span> <span class="token class-name">UnitCell</span><span class="token double-colon punctuation">::</span><span class="token function">read_cell_pseudopots</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string <span class="token operator">&amp;</span>pp_dir<span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>ofstream <span class="token operator">&amp;</span>log<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    std<span class="token double-colon punctuation">::</span>stringstream ss<span class="token punctuation">;</span>
    ss <span class="token operator">&lt;&lt;</span> GlobalV<span class="token double-colon punctuation">::</span>global_out_dir <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;atom_pseudo.log&quot;</span><span class="token punctuation">;</span>

    std<span class="token double-colon punctuation">::</span>string pp_address<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> ntype<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Pseudopot_upf upf<span class="token punctuation">;</span>

        <span class="token keyword">int</span> error <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> error_ap <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>GlobalV<span class="token double-colon punctuation">::</span>MY_RANK<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            pp_address <span class="token operator">=</span> pp_dir <span class="token operator">+</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>pseudo_fn<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            error <span class="token operator">=</span> upf<span class="token punctuation">.</span><span class="token function">init_pseudo_reader</span><span class="token punctuation">(</span> pp_address<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>pseudo_type<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x7684;&#x8BFB;&#x53D6; type-by-type&#xFF0C;&#x6BCF;&#x6B21;&#x521B;&#x5EFA; <code>Pseudopot_upf</code> &#x7C7B;&#x5BF9;&#x8C61; <code>upf</code>&#xFF0C;&#x4E4B;&#x540E;&#x8C03;&#x7528; <code>upf.init_pseudo_reader()</code> &#x5BF9;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x8BFB;&#x53D6;&#xFF0C;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x6587;&#x4EF6;&#x7684;&#x5730;&#x5740;&#xFF08;<code>pp_address</code>&#xFF09;&#x548C;&#x8D5D;&#x52BF;&#x7C7B;&#x578B;&#xFF08;<code>UnitCell::pseudo_type[i]</code>&#xFF09;&#x3002;<code>Pseudopot_upf::init_pseudo_reader()</code> &#x4E3A;&#x6BCF;&#x79CD;&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x5224;&#x65AD;&#xFF0C;&#x4E4B;&#x540E;&#x8FDB;&#x884C;&#x4E0D;&#x540C;&#x7684;&#x89E3;&#x6790;&#x3002;&#x4E3A;&#x65B9;&#x4FBF;&#x8D77;&#x89C1;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EA;&#x5173;&#x6CE8; ABACUS &#x7684;&#x5E38;&#x7528;&#x8D5D;&#x52BF;&#x7C7B;&#x578B;&#xFF0C;&#x5373;&#x6A21;&#x5B88;&#x6052; upf&#x3002;&#x8DDF;&#x968F;&#x201C;&#x8F6C;&#x5230;&#x5B9A;&#x4E49;&#x201D;&#xFF0C;&#x6765;&#x5230; <code>module_cell/read_pp.cpp</code> &#x6587;&#x4EF6;&#xFF08;<a href="https://github.com/abacusmodeling/abacus-develop/blob/develop/source/module_cell/read_pp.cpp" target="_blank">link</a>&#xFF09;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">int</span> <span class="token class-name">Pseudopot_upf</span><span class="token double-colon punctuation">::</span><span class="token function">init_pseudo_reader</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string <span class="token operator">&amp;</span>fn<span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>string <span class="token operator">&amp;</span>type<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    std<span class="token double-colon punctuation">::</span>ifstream <span class="token function">ifs</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>ios<span class="token double-colon punctuation">::</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">&quot;auto&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">set_pseudo_type</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">&quot;upf&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> info <span class="token operator">=</span> <span class="token function">read_pseudo_upf</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> info<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">&quot;vwr&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> info <span class="token operator">=</span> <span class="token function">read_pseudo_vwr</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> info<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">&quot;upf201&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> info <span class="token operator">=</span> <span class="token function">read_pseudo_upf201</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> info<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">&quot;blps&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> info <span class="token operator">=</span> <span class="token function">read_pseudo_blps</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> info<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x9009;&#x62E9; <code>read_pseudo_upf()</code> &#x51FD;&#x6570;&#xFF0C;&#x8DF3;&#x8F6C;&#x5230;&#x4F4D;&#x4E8E; <code>module_cell/read_pp_upf100.cpp</code> &#x7684;&#x8BE5;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x3002;<code>read_pseudo_upf()</code> &#x51FD;&#x6570;&#x5206;&#x6807;&#x7B7E;&#x8BFB;&#x53D6; upf &#x683C;&#x5F0F;&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x4E2D;&#x4FE1;&#x606F;&#xFF0C;&#x6BCF;&#x4E2A;&#x6807;&#x7B7E;&#x90FD;&#x6709;&#x5355;&#x72EC;&#x7684;&#x89E3;&#x6790;&#x5668;&#xFF1A;</p>
<pp_header>

<pre class="language-"><code class="lang-cpp">    <span class="token keyword">while</span> <span class="token punctuation">(</span>ifs<span class="token punctuation">.</span><span class="token function">good</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ifs <span class="token operator">&gt;&gt;</span> dummy<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dummy<span class="token operator">==</span><span class="token string">&quot;&lt;PP_HEADER&gt;&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            ierr <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token function">read_pseudo_header</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">;</span>
            ModuleBase<span class="token double-colon punctuation">::</span><span class="token class-name">GlobalFunc</span><span class="token double-colon punctuation">::</span><span class="token function">SCAN_END</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> <span class="token string">&quot;&lt;/PP_HEADER&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<pp_mesh>

<pre class="language-"><code class="lang-cpp">    <span class="token keyword">if</span> <span class="token punctuation">(</span> ModuleBase<span class="token double-colon punctuation">::</span><span class="token class-name">GlobalFunc</span><span class="token double-colon punctuation">::</span><span class="token function">SCAN_BEGIN</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> <span class="token string">&quot;&lt;PP_MESH&gt;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">read_pseudo_mesh</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ModuleBase<span class="token double-colon punctuation">::</span><span class="token class-name">GlobalFunc</span><span class="token double-colon punctuation">::</span><span class="token function">SCAN_END</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> <span class="token string">&quot;&lt;/PP_MESH&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<pp_nlcc>

<pre class="language-"><code class="lang-cpp">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>nlcc<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ModuleBase<span class="token double-colon punctuation">::</span><span class="token class-name">GlobalFunc</span><span class="token double-colon punctuation">::</span><span class="token function">SCAN_BEGIN</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> <span class="token string">&quot;&lt;PP_NLCC&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token function">read_pseudo_nlcc</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ModuleBase<span class="token double-colon punctuation">::</span><span class="token class-name">GlobalFunc</span><span class="token double-colon punctuation">::</span><span class="token function">SCAN_END</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> <span class="token string">&quot;&lt;/PP_NLCC&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<pp_local>

<pre class="language-"><code class="lang-cpp">    ModuleBase<span class="token double-colon punctuation">::</span><span class="token class-name">GlobalFunc</span><span class="token double-colon punctuation">::</span><span class="token function">SCAN_BEGIN</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> <span class="token string">&quot;&lt;PP_LOCAL&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">read_pseudo_local</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ModuleBase<span class="token double-colon punctuation">::</span><span class="token class-name">GlobalFunc</span><span class="token double-colon punctuation">::</span><span class="token function">SCAN_END</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> <span class="token string">&quot;&lt;/PP_LOCAL&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>&#x4E0E; <pp_local> &#x7C7B;&#x4F3C;&#x7684;&#x8FD8;&#x6709; <pp_nonlocal>, <pp_pswfc>, <pp_rhoatom>, &#x4ECE; <pp_addinfo> &#x5219;&#x53EF;&#x4EE5;&#x8BFB;&#x53D6;&#x65CB;&#x8F68;&#x8026;&#x5408;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF1A;</pp_addinfo></pp_rhoatom></pp_pswfc></pp_nonlocal></pp_local></p>
<pre class="language-"><code class="lang-cpp">    <span class="token keyword">if</span> <span class="token punctuation">(</span>has_so<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ModuleBase<span class="token double-colon punctuation">::</span><span class="token class-name">GlobalFunc</span><span class="token double-colon punctuation">::</span><span class="token function">SCAN_BEGIN</span> <span class="token punctuation">(</span>ifs<span class="token punctuation">,</span><span class="token string">&quot;&lt;PP_ADDINFO&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">read_pseudo_so</span> <span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ModuleBase<span class="token double-colon punctuation">::</span><span class="token class-name">GlobalFunc</span><span class="token double-colon punctuation">::</span><span class="token function">SCAN_END</span> <span class="token punctuation">(</span>ifs<span class="token punctuation">,</span><span class="token string">&quot;&lt;/PP_ADDINFO&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>&#x6BCF;&#x4E2A;&#x5177;&#x4F53; tag &#x7684;&#x89E3;&#x6790;&#x51FD;&#x6570; <code>Pseudopot_upf::read_pseudo_xxx()</code> &#x5747;&#x8D4B;&#x503C;&#x4E8E;&#x6570;&#x636E;&#x6210;&#x5458;&#xFF0C;&#x58F0;&#x660E;&#x5728; <code>module_cell/read_pp.h</code> &#x4E2D;&#xFF08;<a href="https://github.com/abacusmodeling/abacus-develop/blob/develop/source/module_cell/read_pp.h" target="_blank">link</a>&#xFF09;&#x3002;</p>
<table>
<thead>
<tr>
<th><strong>Functions in Pseudopot_upf class</strong></th>
<th><strong>Variables value assgined</strong></th>
<th><strong>explain</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>void read_pseudo_header(std::ifstream &amp;ifs);</code></td>
<td><code>this-&gt;nv``this-&gt;psd``this-&gt;tvanp``this-&gt;nlcc``this-&gt;xc_func``this-&gt;zp``this-&gt;etotps``this-&gt;ecutwfc``this-&gt;ecutrho``this-&gt;lmax``this-&gt;mesh``this-&gt;nwfc``this-&gt;nbeta``this-&gt;els``this-&gt;lchi``this-&gt;oc</code></td>
<td>Version numberElement labelIf ultrasoft pseudopotentialIf noncolinear correction addedXc functionalAtomic chargesTotal energySuggested energy cutoff for wavefunctionSuggested energy cutoff for charge densityMaximal angular momentum includedNumber of points in radial meshNumber of wavefunctionsNumber of projectorsDim <code>nwfc</code>, labels of orbitalDim <code>nwfc</code>, angular momentum of orbitalDim <code>nwfc</code>, occupation of orbital</td>
<td></td>
</tr>
<tr>
<td><code>void read_pseudo_mesh(std::ifstream &amp;ifs);</code></td>
<td><code>this-&gt;r``this-&gt;rab</code></td>
<td>Dim <code>this-&gt;mesh</code>, realspace mesh of radiusDim <code>this-&gt;mesh</code>,</td>
<td></td>
</tr>
<tr>
<td><code>void read_pseudo_nlcc(std::ifstream &amp;ifs);</code></td>
<td><code>this-&gt;rho_atc</code></td>
<td>Dim <code>this-&gt;mesh</code>,</td>
<td></td>
</tr>
<tr>
<td><code>void read_pseudo_local(std::ifstream &amp;ifs);</code></td>
<td><code>this-&gt;vloc</code></td>
<td>Dim <code>this-&gt;mesh</code>, Vlocal</td>
<td></td>
</tr>
<tr>
<td><code>void read_pseudo_nl(std::ifstream &amp;ifs);</code></td>
<td><code>this-&gt;kkbeta</code>              <code>this-&gt;lll</code>               <code>this-&gt;beta``this-&gt;dion``this-&gt;nd</code></td>
<td>Dim <code>this-&gt;nbeta</code>, number of mesh points of projectors.Dim <code>this-&gt;nbeta</code>, angular momentum for projectors.Dim <code>this-&gt;nbeta</code><em><code>this-&gt;mesh</code>.Dim <code>this-&gt;nbeta</code></em><code>this-&gt;nbeta</code>.Number of nonzero <script type="math/tex; ">D_{ij}</script></td>
<td></td>
</tr>
<tr>
<td><code>void read_pseudo_pswfc(std::ifstream &amp;ifs);</code></td>
<td><code>this-&gt;chi</code></td>
<td>Dim <code>this-&gt;nwfc</code>*<code>this-&gt;mesh</code>,</td>
<td></td>
</tr>
<tr>
<td><code>void read_pseudo_rhoatom(std::ifstream &amp;ifs);</code></td>
<td><code>this-&gt;rho_at</code></td>
<td>Dim <code>this-&gt;mesh</code>, atomic electron density on realspace mesh</td>
<td></td>
</tr>
<tr>
<td><code>void read_pseudo_addinfo(std::ifstream &amp;ifs);</code></td>
<td><em>Not implemented</em></td>
<td><em>Not implemented</em></td>
<td></td>
</tr>
<tr>
<td><code>void read_pseudo_so(std::ifstream &amp;ifs);</code></td>
<td><code>this-&gt;nn</code>              <code>this-&gt;jchi``this-&gt;jjj</code></td>
<td>Dim <code>this-&gt;nwfc</code>, quantum number of wavefunctionDim <code>this-&gt;nwfc</code>, <script type="math/tex; ">j=l+s</script>, where <script type="math/tex; ">s=\pm\frac{1}{2}</script>.Dim <code>this-&gt;nbeta</code>, <script type="math/tex; ">j=l+s</script>, where <script type="math/tex; ">s=\pm\frac{1}{2}</script>, for projector.</td>
</tr>
</tbody>
</table>
<p>&#x6211;&#x4EEC;&#x5047;&#x8BBE; ONCV.upf &#x683C;&#x5F0F;&#x8D5D;&#x52BF;&#x6587;&#x4EF6;&#x987A;&#x5229;&#x8BFB;&#x53D6;&#x5B8C;&#x6BD5;&#xFF0C;<code>upf.init_pseudo_reader()</code> &#x8FD4;&#x56DE; 0&#xFF08;<code>error == 0</code>&#xFF09;&#xFF0C;&#x6765;&#x5230;&#x6761;&#x4EF6;&#x5224;&#x65AD;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp">            <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>atoms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>flag_empty_element<span class="token punctuation">)</span> upf<span class="token punctuation">.</span><span class="token function">set_empty_element</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            
                error_ap <span class="token operator">=</span> upf<span class="token punctuation">.</span><span class="token function">average_p</span><span class="token punctuation">(</span>GlobalV<span class="token double-colon punctuation">::</span>soc_lambda<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
</code></pre>
<p><code>Pseudopot_upf::set_empty_element()</code> &#x7684;&#x4F5C;&#x7528;&#x4E3A;&#x8BBE;&#x7F6E; <code>Vloc</code>&#x3001;<code>dion</code> &#x548C; <code>rho_at</code> &#x5747;&#x4E3A; 0&#xFF0C;<code>Pseudopot_upf::average_p()</code> &#x5219;&#x5C5E;&#x4E8E;&#x81EA;&#x65CB;&#x8F68;&#x9053;&#x8026;&#x5408;&#xFF08;spin-orbital coupling&#xFF09;&#x529F;&#x80FD;&#xFF0C;&#x8FD9;&#x91CC;&#x5148;&#x4E0D;&#x4ECB;&#x7ECD;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x6765;&#x5230; line 82,</p>
<pre class="language-"><code class="lang-cpp">                <span class="token keyword">if</span><span class="token punctuation">(</span>GlobalV<span class="token double-colon punctuation">::</span>MY_RANK<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                        atoms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span><span class="token function">set_pseudo_nc</span><span class="token punctuation">(</span> upf <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
                <span class="token punctuation">}</span>
</code></pre>
<p>&#x5B9E;&#x9645;&#x4E0A; ABACUS &#x76EE;&#x524D;&#x53EA;&#x80FD;&#x5904;&#x7406;&#x6A21;&#x5B88;&#x6052;&#x7684;&#x8D5D;&#x52BF;&#x7C7B;&#x578B;&#x3002;&#x663E;&#x7136;&#x8BE5;&#x884C;&#x5B9E;&#x73B0;&#x7684;&#x4E3A;<strong>&#x5C06;&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x4ECE;upf&#x5230;atoms[i].ncpp&#x7684;&#x62F7;&#x8D1D;</strong>&#xFF0C;&#x800C; upf &#x7684;&#x610F;&#x4E49;&#x4E5F;&#x4E0D;&#x8A00;&#x81EA;&#x660E;&#xFF1A;UPF file parser&#x3002;&#x89E3;&#x6790; UPF &#x6587;&#x4EF6;&#x540E;&#x4F20;&#x503C;&#x7ED9; <code>atoms[i].ncpp</code></p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">void</span> pseudo_nc<span class="token double-colon punctuation">::</span><span class="token function">set_pseudo_nc</span><span class="token punctuation">(</span><span class="token keyword">const</span> Pseudopot_upf <span class="token operator">&amp;</span>upf<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">set_pseudo_h</span><span class="token punctuation">(</span>upf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">set_pseudo_atom</span><span class="token punctuation">(</span>upf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">set_pseudo_vl</span><span class="token punctuation">(</span>upf<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> lll<span class="token punctuation">;</span> lll <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nbeta<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> nbeta<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> lll<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> upf<span class="token punctuation">.</span>lll<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        nh <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> nb <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> nb <span class="token operator">&lt;</span> nbeta<span class="token punctuation">;</span>nb<span class="token operator">++</span><span class="token punctuation">)</span> nh <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> lll <span class="token punctuation">[</span>nb<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token operator">-&gt;</span>kkbeta <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> nb <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>nb <span class="token operator">&lt;</span> nbeta<span class="token punctuation">;</span>nb<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token operator">-&gt;</span>kkbeta <span class="token operator">=</span> <span class="token punctuation">(</span>upf<span class="token punctuation">.</span>kkbeta<span class="token punctuation">[</span>nb<span class="token punctuation">]</span> <span class="token operator">&gt;</span> kkbeta<span class="token punctuation">)</span> <span class="token operator">?</span> upf<span class="token punctuation">.</span>kkbeta<span class="token punctuation">[</span>nb<span class="token punctuation">]</span> <span class="token operator">:</span> kkbeta<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token operator">-&gt;</span>betar<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>upf<span class="token punctuation">.</span>beta<span class="token punctuation">.</span>nr<span class="token punctuation">,</span> upf<span class="token punctuation">.</span>beta<span class="token punctuation">.</span>nc<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>betar <span class="token operator">=</span> upf<span class="token punctuation">.</span>beta<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span>dion<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>nbeta<span class="token punctuation">,</span> nbeta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>dion <span class="token operator">=</span> upf<span class="token punctuation">.</span>dion<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x8BE5;&#x51FD;&#x6570;&#x5C5E;&#x4E8E;&#x7C7B; <code>pseudo_nc</code>&#xFF0C;&#x800C; <code>pseudo_nc</code> &#x5BF9;&#x8C61;&#x4E3A; <code>atom</code> &#x7684;&#x6570;&#x636E;&#x6210;&#x5458;&#xFF0C;<code>atoms</code> &#x5219;&#x4E3A; <code>UnitCell</code> &#x7684;&#x6570;&#x636E;&#x6210;&#x5458;&#x3002;<code>pseudo_nc::set_pseudo_h()</code>&#xFF0C;<code>pseudo_nc::set_pseudo_atom</code> &#x548C; <code>pseudo_nc::set_pseudo_vl</code> &#x7684;&#x5185;&#x5BB9;&#x5728;&#x6B64;&#x7701;&#x7565;&#xFF0C;&#x4F46;&#x5176;&#x5206;&#x522B;&#x4E3A;&#x5C06; Hamilton, &#x539F;&#x5B50;&#x6027;&#x8D28;&#x548C; Vlocal &#x76F8;&#x5173;&#x6570;&#x636E;&#x4ECE; upf &#x5BF9;&#x8C61;&#x62F7;&#x8D1D;&#x3002;&#x4E4B;&#x540E;(1)&#x4F7F;&#x7528; <code>lll</code> &#x5237;&#x65B0;&#x4E3A; upf &#x5BF9;&#x8C61;&#x7684; projectors &#x7684;&#x89D2;&#x52A8;&#x91CF;&#xFF0C;&#x7136;&#x540E;&#x8BA1;&#x7B97;&#x51FA;&#x78C1;&#x89D2;&#x52A8;&#x91CF;&#x533A;&#x5206;&#x65F6;&#x7684; projector &#x4E2A;&#x6570;&#x3002;(2)&#x53D6;&#x6240;&#x6709; projector &#x8870;&#x51CF;&#x5230; 0 &#x65F6;&#x5019;&#x7684;&#x6700;&#x5927;&#x6700;&#x666E;&#x9002;&#x534A;&#x5F84;&#x3002;</p>
<h4 id="&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x540E;&#x5904;&#x7406;"><a name="&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x540E;&#x5904;&#x7406;" class="plugin-anchor" href="#&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x540E;&#x5904;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x540E;&#x5904;&#x7406;</h4>
<p>&#x56DE;&#x5230; <code>module_cell/unitcell.cpp</code> line 663&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x4E3A;&#x6BCF;&#x4E2A;&#x539F;&#x5B50;&#x521B;&#x5EFA;&#x76EE;&#x5F55;&#xFF0C;&#x5728;&#x76EE;&#x5F55;&#x4E2D;&#x5199; <code>[&#x539F;&#x5B50;label].NONLOCAL</code> &#x6587;&#x4EF6;&#x3002;<code>[label].NONLOCAL</code> &#x6587;&#x4EF6;&#x4E2D;&#x5185;&#x5BB9;&#x5305;&#x542B; <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HEADER</span><span class="token punctuation">&gt;</span></span></code>, <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DIJ</span><span class="token punctuation">&gt;</span></span></code> &#x548C; <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_BETA</span><span class="token punctuation">&gt;</span></span></code> &#x4E09;&#x4E2A; tag&#x3002;</p>
<p><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HEADER</span><span class="token punctuation">&gt;</span></span></code> &#x4E2D;&#x5305;&#x542B;&#x5185;&#x5BB9;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp">ofs <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;&lt;HEADER&gt;&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
            ofs <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> atom<span class="token operator">-&gt;</span>label <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;label&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
            ofs <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>pp_type <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;pseudopotential type&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
            ofs <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>lmax <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;lmax&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
            ofs <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;&lt;/HEADER&gt;&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
</code></pre>
<p><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DIJ</span><span class="token punctuation">&gt;</span></span></code> &#x4E2D;&#x5305;&#x542B;&#x5185;&#x5BB9;&#x4E3A; projector &#x6570;&#x91CF; <code>atom-&gt;ncpp.nbeta</code>&#x3001;&#x5BF9;&#x5E94;&#x4E8E;&#x6BCF;&#x4E2A;&#x539F;&#x5B50;&#x7684; projector &#x7684;&#x89D2;&#x52A8;&#x91CF;&#x4E3A;&#x6307;&#x6807;&#x7684; <code>dion</code> &#x77E9;&#x9635;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp">ofs <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;\n&lt;DIJ&gt;&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
            ofs <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>nbeta <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;\t&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;nummber of projectors.&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> ib<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ib<span class="token operator">&lt;</span>atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>nbeta<span class="token punctuation">;</span> ib<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> ib2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ib2<span class="token operator">&lt;</span>atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>nbeta<span class="token punctuation">;</span> ib2<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    ofs <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>lll<span class="token punctuation">[</span>ib<span class="token punctuation">]</span> 
                        <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span> <span class="token operator">&lt;&lt;</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>lll<span class="token punctuation">[</span>ib2<span class="token punctuation">]</span>
                        <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span> <span class="token operator">&lt;&lt;</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span><span class="token function">dion</span><span class="token punctuation">(</span>ib<span class="token punctuation">,</span>ib2<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            ofs <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;&lt;/DIJ&gt;&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
</code></pre>
<p><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PP_BETA</span><span class="token punctuation">&gt;</span></span></code> &#x4E2D;&#x5305;&#x542B;&#x5185;&#x5BB9;&#x4E3A; projector &#x4EC5;&#x5176;&#x503C;&#x5927;&#x4E8E; 1.0e-10 &#x7684;&#x503C;&#x3002;&#x9996;&#x5148;&#x4ECD;&#x7136;&#x8F93;&#x51FA;&#x5F53;&#x524D;&#x539F;&#x5B50;&#x7684; projector &#x7D22;&#x5F15;&#xFF0C;&#x4EE5;&#x53CA;&#x89D2;&#x52A8;&#x91CF;&#xFF0C;&#x7136;&#x540E;&#x622A;&#x65AD; projector:</p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">int</span> cut_mesh <span class="token operator">=</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>mesh<span class="token punctuation">;</span> 
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>mesh<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span> std<span class="token double-colon punctuation">::</span><span class="token function">abs</span><span class="token punctuation">(</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span><span class="token function">betar</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1.0e-10</span> <span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        cut_mesh <span class="token operator">=</span> j<span class="token punctuation">;</span> 
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>cut_mesh <span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">++</span>cut_mesh<span class="token punctuation">;</span>
</code></pre>
<p>&#x4E4B;&#x540E;&#x6309;&#x7167;&#x622A;&#x65AD;&#x540E;&#x7684;&#x7F51;&#x683C;&#x91CD;&#x65B0;&#x5B58;&#x50A8; projector &#x7684; <code>realspace grid</code>, <code>projector value</code>, <code>rab</code> &#x6570;&#x636E;&#xFF0C;&#x5206;&#x4E09;&#x5217;&#x5206;&#x522B;&#x5B58;&#x50A8;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>cut_mesh<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    ofs <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>r<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
                        <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span><span class="token function">betar</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
                        <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> atom<span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span>rab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                ofs <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;&lt;/PP_BETA&gt;&quot;</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
</code></pre>
<h4 id="&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x5206;&#x53D1;&#xFF1A;unitcellbcastunitcell2void"><a name="&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x5206;&#x53D1;&#xFF1A;unitcellbcastunitcell2void" class="plugin-anchor" href="#&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x5206;&#x53D1;&#xFF1A;unitcellbcastunitcell2void"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x5206;&#x53D1;&#xFF1A;UnitCell::bcast_unitcell2(void)</h4>
<p><code>#ifdef __MPI</code></p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x5BF9;&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x8FDB;&#x884C;MPI&#x8FDB;&#x7A0B;&#xFF08;processor&#xFF09;&#x95F4;&#x7684;&#x5206;&#x53D1;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__MPI</span></span>
    <span class="token function">bcast_unitcell2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre>
<pre class="language-"><code class="lang-cpp"><span class="token comment">// module_cell/unitcell.cpp:bcast_unitcell2()</span>
<span class="token keyword">void</span> <span class="token class-name">UnitCell</span><span class="token double-colon punctuation">::</span><span class="token function">bcast_unitcell2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ntype<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        atoms<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">bcast_atom2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-cpp"><span class="token comment">// module_cell/atom_spec.cpp:Atom::bcast_atom2()</span>
<span class="token keyword">void</span> <span class="token class-name">Atom</span><span class="token double-colon punctuation">::</span><span class="token function">bcast_atom2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>ncpp<span class="token punctuation">.</span><span class="token function">bcast_atom_pseudo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-cpp"><span class="token comment">// module_cell/atom_pseudo.cpp::Atom_pseudo::bcast_atom_pseudo()</span>
<span class="token keyword">void</span> <span class="token class-name">Atom_pseudo</span><span class="token double-colon punctuation">::</span><span class="token function">bcast_atom_pseudo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token class-name">Parallel_Common</span><span class="token double-colon punctuation">::</span><span class="token function">bcast_int</span><span class="token punctuation">(</span> lmax <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token class-name">Parallel_Common</span><span class="token double-colon punctuation">::</span><span class="token function">bcast_double</span><span class="token punctuation">(</span> etotps <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token class-name">Parallel_Common</span><span class="token double-colon punctuation">::</span><span class="token function">bcast_bool</span><span class="token punctuation">(</span> tvanp <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token class-name">Parallel_Common</span><span class="token double-colon punctuation">::</span><span class="token function">bcast_string</span><span class="token punctuation">(</span> psd <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment">// below two &apos;bcast_double&apos; lines of codes seem to have bugs,</span>
        <span class="token comment">// on some computers, the code will stuck here for ever.</span>
        <span class="token comment">// mohan note 2021-04-28</span>
        <span class="token class-name">Parallel_Common</span><span class="token double-colon punctuation">::</span><span class="token function">bcast_double</span><span class="token punctuation">(</span> dion<span class="token punctuation">.</span>c <span class="token punctuation">,</span> nbeta <span class="token operator">*</span> nbeta<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Parallel_Common</span><span class="token double-colon punctuation">::</span><span class="token function">bcast_double</span><span class="token punctuation">(</span> betar<span class="token punctuation">.</span>c<span class="token punctuation">,</span> nr <span class="token operator">*</span> nc <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><code>#endif</code></p>
<h4 id="&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x6838;&#x5BF9;"><a name="&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x6838;&#x5BF9;" class="plugin-anchor" href="#&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x6838;&#x5BF9;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8D5D;&#x52BF;&#x4FE1;&#x606F;&#x6838;&#x5BF9;</h4>
<p>&#x63A5;&#x4E0B;&#x6765;&#x8DE8;&#x539F;&#x5B50;&#x79CD;&#x7C7B;&#x68C0;&#x9A8C;&#x6CDB;&#x51FD;&#x662F;&#x5426;&#x4E00;&#x81F4;&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp">    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> it<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> it<span class="token operator">&lt;</span>ntype<span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>atoms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span>xc_func <span class="token operator">!=</span>atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span>xc_func<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
</code></pre>
<h4 id="stru-&#x7ED3;&#x6784;&#x68C0;&#x67E5;&#xFF1A;unitcellcheckstructure"><a name="stru-&#x7ED3;&#x6784;&#x68C0;&#x67E5;&#xFF1A;unitcellcheckstructure" class="plugin-anchor" href="#stru-&#x7ED3;&#x6784;&#x68C0;&#x67E5;&#xFF1A;unitcellcheckstructure"><i class="fa fa-link" aria-hidden="true"></i></a>STRU &#x7ED3;&#x6784;&#x68C0;&#x67E5;&#xFF1A;UnitCell::check_structure()</h4>
<p>&#x68C0;&#x9A8C;&#x7ED3;&#x6784;&#x4E2D;&#x4EFB;&#x610F;&#x4E24;&#x539F;&#x5B50;&#x4E4B;&#x95F4;&#x8DDD;&#x79BB;&#x662F;&#x5426;&#x5927;&#x4E8E;&#x5176;&#x56FA;&#x5B9A;&#x500D;&#x6570;&#xFF08;&lt;1&#xFF09;&#x7684;&#x5171;&#x4EF7;&#x534A;&#x5F84;&#x548C;&#xFF0C;</p>
<pre class="language-"><code class="lang-cpp">    <span class="token function">check_structure</span><span class="token punctuation">(</span>GlobalV<span class="token double-colon punctuation">::</span>MIN_DIST_COEF<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="&#x8BA1;&#x7B97;&#x8F68;&#x9053;&#x6570;&#xFF1A;unitcellcalnatomwfc"><a name="&#x8BA1;&#x7B97;&#x8F68;&#x9053;&#x6570;&#xFF1A;unitcellcalnatomwfc" class="plugin-anchor" href="#&#x8BA1;&#x7B97;&#x8F68;&#x9053;&#x6570;&#xFF1A;unitcellcalnatomwfc"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8BA1;&#x7B97;&#x8F68;&#x9053;&#x6570;&#xFF1A;UnitCell::cal_natomwfc()</h4>
<p><code>UnitCell::cal_natomwfc()</code> &#x51FD;&#x6570;&#x8BA1;&#x7B97;&#x6240;&#x6709;&#x79CD;&#x7C7B;&#x7684;&#x539F;&#x5B50;&#x8F68;&#x9053;&#x6570;&#x91CF;&#x52A0;&#x548C;&#xFF0C;&#x5BF9;&#x4E8E;&#x975E; <code>nspin=4</code>&#xFF0C;&#x5373;&#x975E; soc&#xFF08;&#x81EA;&#x65CB;&#x8F68;&#x9053;&#x8026;&#x5408;&#xFF09;&#x60C5;&#x51B5;&#xFF0C;&#x89D2;&#x91CF;&#x5B50;&#x6570; l &#x548C; s &#x975E;&#x8026;&#x5408;&#xFF0C;l &#x5355;&#x72EC;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x597D;&#x7684;&#x91CF;&#x5B50;&#x6570;&#x6765;&#x533A;&#x5206;&#x91CF;&#x5B50;&#x6001;&#xFF0C;&#x56E0;&#x6B64;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x8D5D;&#x52BF;&#x4E2D;&#x5B9A;&#x4E49;&#x7684; wfc&#xFF0C;&#x82E5;&#x5176;&#x5BF9;&#x5E94; occupation &#x5927;&#x4E8E;&#x7B49;&#x4E8E; 0&#xFF08;&#x5373;&#x6709;&#x6548; wfc&#xFF09;&#xFF0C;&#x5219;&#x5BF9;&#x5E94;&#x4E8E;&#x5176;&#x89D2;&#x91CF;&#x5B50;&#x6570; l&#xFF0C;&#x8F68;&#x9053;&#x6570;&#x91CF;&#x589E;&#x52A0; 2l+1&#xFF0C;&#x5373;&#x8BA1;&#x6570;&#x5176;&#x78C1;&#x91CF;&#x5B50;&#x6570; m&#xFF0C;&#x4E5F;&#x76F8;&#x5F53;&#x4E8E;&#x5BF9; alpha &#x548C; beta spin &#x7684;&#x5355;&#x72EC;&#x8BA1;&#x6570;&#x3002;&#x5BF9;&#x4E8E; <code>nspin=4</code> &#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x82E5;&#x8003;&#x8651; soc&#xFF0C;&#x5219;&#x8F68;&#x9053;&#x6570;&#x5BF9; j=l+s &#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x5F53;&#x524D;&#x539F;&#x5B50;&#x79CD;&#x7C7B;&#x5F53;&#x524D;&#x89D2;&#x91CF;&#x5B50;&#x6570;&#x5BF9;&#x5E94;&#x8F68;&#x9053;&#x6570;&#x91CF;&#x8BB0;&#x4E3A; 2l+1+1&#xFF0C;&#x5426;&#x5219;&#x4E3A; 2l+1&#x3002;&#x5BF9;&#x4E8E;&#x975E; soc &#x4F46; <code>nspin=4</code>&#xFF0C;&#x5F53;&#x524D;&#x539F;&#x5B50;&#x79CD;&#x7C7B;&#x8F68;&#x9053;&#x5F53;&#x524D;&#x89D2;&#x91CF;&#x5B50;&#x6570;&#x5BF9;&#x5E94;&#x8F68;&#x9053;&#x6570;&#x91CF;&#x8BB0;(2l+1)*2&#xFF1A;</p>
<pre class="language-"><code class="lang-cpp"><span class="token keyword">void</span> <span class="token class-name">UnitCell</span><span class="token double-colon punctuation">::</span><span class="token function">cal_natomwfc</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>ofstream <span class="token operator">&amp;</span>log<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span>natomwfc <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> it <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>it <span class="token operator">&lt;</span> ntype<span class="token punctuation">;</span>it<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
                <span class="token keyword">int</span> tmp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>l <span class="token operator">&lt;</span> atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span>nchi<span class="token punctuation">;</span>l<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span>oc<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{</span>
                                <span class="token keyword">if</span><span class="token punctuation">(</span>GlobalV<span class="token double-colon punctuation">::</span>NSPIN<span class="token operator">==</span><span class="token number">4</span><span class="token punctuation">)</span>
                                <span class="token punctuation">{</span>
                                        <span class="token keyword">if</span><span class="token punctuation">(</span>atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span>has_so<span class="token punctuation">)</span>
                                        <span class="token punctuation">{</span>
                                                tmp <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span>lchi<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
                                                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span>jchi<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">-</span> atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span>lchi<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1e-6</span><span class="token punctuation">)</span> tmp <span class="token operator">+=</span> <span class="token number">2</span> <span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">else</span> tmp <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span>lchi<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                                <span class="token keyword">else</span> tmp <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>ncpp<span class="token punctuation">.</span>lchi<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                natomwfc <span class="token operator">+=</span> tmp <span class="token operator">*</span> atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>na<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x63A5;&#x4E0B;&#x6765;&#x8C03;&#x7528; <code>UnitCell::cal_nwfc()</code> &#x51FD;&#x6570;&#xFF0C;&#x8BA1;&#x7B97;&#x5E76;&#x8D4B;&#x503C;</p>
<ol>
<li>&#x6CE2;&#x51FD;&#x6570; index &#x5230;&#x89D2;&#x52A8;&#x91CF;&#xFF0C;zeta &#x548C;&#x78C1;&#x91CF;&#x5B50;&#x6570;&#x7684;&#x8868;&#x683C;&#xFF0C;</li>
<li>&#x8DE8;&#x539F;&#x5B50;&#x79CD;&#x7C7B;&#x7684;&#x6700;&#x5927;&#x539F;&#x5B50;&#x6570;&#xFF0C;&#x4EE5;&#x53CA;&#x6700;&#x5927; wfc &#x6570;&#x91CF;&#xFF0C;</li>
<li>&#x8F68;&#x9053;&#x6570;&#x91CF;&#x548C;&#xFF1A;</li>
</ol>
<pre class="language-"><code class="lang-cpp">GlobalV<span class="token double-colon punctuation">::</span>NLOCAL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> it<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> it<span class="token operator">&lt;</span>ntype<span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
                atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>stapos_wf <span class="token operator">=</span> GlobalV<span class="token double-colon punctuation">::</span>NLOCAL<span class="token punctuation">;</span>
                <span class="token keyword">const</span> <span class="token keyword">int</span> nlocal_it <span class="token operator">=</span> atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>nw <span class="token operator">*</span> atoms<span class="token punctuation">[</span>it<span class="token punctuation">]</span><span class="token punctuation">.</span>na<span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>GlobalV<span class="token double-colon punctuation">::</span>NSPIN<span class="token operator">!=</span><span class="token number">4</span><span class="token punctuation">)</span> 
                <span class="token punctuation">{</span>
                        GlobalV<span class="token double-colon punctuation">::</span>NLOCAL <span class="token operator">+=</span> nlocal_it<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> 
                <span class="token punctuation">{</span>
                        GlobalV<span class="token double-colon punctuation">::</span>NLOCAL <span class="token operator">+=</span> nlocal_it <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//zhengdy-soc</span>
                <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
</code></pre>
<ol>
<li>&#x5EFA;&#x7ACB; <code>UnitCell::itia2iat</code>&#xFF08;&#x79CD;&#x7C7B; index&#xFF0C;&#x79CD;&#x7C7B;&#x5185;&#x539F;&#x5B50; index&#xFF09;-&gt;&#xFF08;&#x539F;&#x5B50;&#x5168;&#x5C40; index&#xFF09;&#x6620;&#x5C04;&#x8868;&#x3001;<code>UnitCell::iat2iwt</code>&#xFF08;&#x539F;&#x5B50;&#x5168;&#x5C40; index&#xFF09;-&gt;&#xFF08;&#x6CE2;&#x51FD;&#x6570;&#x5168;&#x5C40; index&#xFF09;&#x6620;&#x5C04;&#x8868;&#x3001;<code>UnitCell::iwt2iw</code>&#xFF08;&#x6CE2;&#x51FD;&#x6570;&#x5168;&#x5C40; index&#xFF09;-&gt;&#xFF08;&#x6CE2;&#x51FD;&#x6570;&#x79CD;&#x7C7B;&#x5185; index&#xFF09;&#x6620;&#x5C04;&#x8868;&#x3001;<code>UnitCell::iwt2iat</code>&#xFF08;&#x6CE2;&#x51FD;&#x6570;&#x5168;&#x5C40; index&#xFF09;-&gt;&#xFF08;&#x539F;&#x5B50;&#x5168;&#x5C40; index&#xFF09;&#x6620;&#x5C04;&#x8868;&#x3001;<code>UnitCell::iwt2iw</code>&#xFF08;&#x6CE2;&#x51FD;&#x6570;&#x5168;&#x5C40; index&#xFF09;-&gt;&#xFF08;&#x6CE2;&#x51FD;&#x6570;&#x79CD;&#x7C7B;&#x5185; index&#xFF09;&#x6620;&#x5C04;&#x8868;&#x3002;</li>
<li>&#x8BA1;&#x7B97;&#x8DE8;&#x539F;&#x5B50;&#x79CD;&#x7C7B;&#x6700;&#x5927;&#x89D2;&#x91CF;&#x5B50;&#x6570; UnitCell::lmax &#x548C;&#x67D0; l &#x5BF9;&#x5E94;&#x6700;&#x5927; zeta &#x6570; <code>UnitCell::nmax</code>&#xFF0C;&#x4EE5;&#x53CA;&#x8DE8;&#x539F;&#x5B50;&#x79CD;&#x7C7B;&#x7684;&#x7C7B;&#x5185; zeta &#x6570;&#x603B;&#x548C;&#x6700;&#x5927;&#x503C; UnitCell::nmax_total</li>
<li>&#x5BFB;&#x627E;&#x8D5D;&#x52BF;&#x4E2D;&#x6700;&#x5927;&#x89D2;&#x91CF;&#x5B50;&#x6570; <code>UnitCell::lmax_ppwf</code>&#x3002;</li>
</ol>
<h4 id="&#x4EF7;&#x7535;&#x5B50;&#x6570;&#x6838;&#x5BF9;"><a name="&#x4EF7;&#x7535;&#x5B50;&#x6570;&#x6838;&#x5BF9;" class="plugin-anchor" href="#&#x4EF7;&#x7535;&#x5B50;&#x6570;&#x6838;&#x5BF9;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4EF7;&#x7535;&#x5B50;&#x6570;&#x6838;&#x5BF9;</h4>
<p>&#x6838;&#x5BF9;&#x8D5D;&#x52BF;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x4EF7;&#x7535;&#x5B50;&#x6570;&#x4E0E; ABACUS &#x9884;&#x7F6E;&#x5E93;&#x4E2D;&#x539F;&#x5B50;&#x7684;&#x6700;&#x5C0F;&#x4EF7;&#x7535;&#x5B50;&#x6570;</p>
<h4 id="&#x83B7;&#x53D6;&#x6700;&#x5927;&#x683C;&#x70B9;&#x6570;&#x91CF;&#xFF1A;unitcellcalmeshx"><a name="&#x83B7;&#x53D6;&#x6700;&#x5927;&#x683C;&#x70B9;&#x6570;&#x91CF;&#xFF1A;unitcellcalmeshx" class="plugin-anchor" href="#&#x83B7;&#x53D6;&#x6700;&#x5927;&#x683C;&#x70B9;&#x6570;&#x91CF;&#xFF1A;unitcellcalmeshx"><i class="fa fa-link" aria-hidden="true"></i></a>&#x83B7;&#x53D6;&#x6700;&#x5927;&#x683C;&#x70B9;&#x6570;&#x91CF;&#xFF1A;UnitCell::cal_meshx()</h4>
<p>&#x8BA1;&#x7B97;&#x8DE8;&#x539F;&#x5B50;&#x79CD;&#x7C7B;&#x7684;&#x6700;&#x5927;&#x683C;&#x70B9;&#x6570;&#x91CF;&#xFF0C;&#x5B58;&#x50A8;&#x5728; <code>UnitCell::meshx</code> &#x4E2D;&#xFF0C;&#x76EE;&#x524D; ABACUS &#x4EE3;&#x7801;&#x4E2D;&#x53D8;&#x91CF;&#x547D;&#x540D;&#x540E;&#x7F00; x &#x53EF;&#x80FD;&#x4EE3;&#x8868; max&#xFF0C;&#x6B63;&#x5982;&#x4E4B;&#x524D;&#x770B;&#x5230; <code>npwx</code> &#x7B49;&#x3002;</p>
<p>&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x79BB;&#x5F00;&#x51FD;&#x6570; <code>UnitCell::read_pseudo()</code>&#xFF0C;&#x56DE;&#x5230; <code>ModuleESolver::ESolver_FP::Init()</code> &#x51FD;&#x6570;&#x3002;</p>
<blockquote>
<p>&#x1F4C3;<strong>&#x548C; Quantum Espresso &#x5BF9;&#x9F50;&#x7684;&#x8D5D;&#x52BF;&#x53C2;&#x6570;</strong>
&#x8BFB;&#x5165; UPF &#x683C;&#x5F0F;&#x7684;&#x6A21;&#x5B88;&#x6052;&#x8D5D;&#x52BF;&#x4E4B;&#x540E;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x548C; QE &#x7684;&#x7ED3;&#x679C;&#x505A; apple-to-apple &#x7684;&#x6BD4;&#x8F83;&#xFF0C;&#x4F7F;&#x5F97;&#x603B;&#x80FD;&#x91CF;&#x53D7;&#x529B;&#x7B49;&#x6027;&#x8D28;&#x8BA1;&#x7B97;&#x4E00;&#x81F4;&#xFF0C;&#x53EF;&#x4EE5;&#x628A;&#x57FA;&#x77E2;&#x91CF;&#x8C03;&#x6210;&#x5E73;&#x9762;&#x6CE2;(<code>basis_type</code> &#x8BBE;&#x6210; pw)&#xFF0C;&#x7136;&#x540E;&#x5728; <code>INPUT</code> &#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x628A; <code>pseudo_rcut</code> &#x8BBE;&#x6210; 10&#xFF08;&#x9ED8;&#x8BA4;&#x662F; 15&#xFF09;&#xFF0C;<code>pseudo_mesh</code> &#x8BBE;&#x6210; 1 &#x5373;&#x53EF;&#xFF08;&#x9ED8;&#x8BA4;&#x662F; 0&#xFF09;&#x3002;</p>
</blockquote>
<h1 id="&#x7CFB;&#x5217;&#x94FE;&#x63A5;"><a name="&#x7CFB;&#x5217;&#x94FE;&#x63A5;" class="plugin-anchor" href="#&#x7CFB;&#x5217;&#x94FE;&#x63A5;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7CFB;&#x5217;&#x94FE;&#x63A5;</h1>
<p>&#x4E0A;&#x7BC7;&#xFF1A;<a href="develop-path2.html">Introduction to ABACUS: Path to PW calculation - Part 2</a></p>
<p>&#x4E0B;&#x7BC7;&#xFF1A;<a href="develop-path4.html">Introduction to ABACUS: Path to PW calculation - Part 4</a> </p>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; mcresearch.gitee.io 2023 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x8BE5;&#x6587;&#x7AE0;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A;
2023-10-04 23:11:45
</span></footer></pp_local></pp_nlcc></pp_mesh></pp_header>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="develop-path2.html" class="navigation navigation-prev " aria-label="Previous page: Introduction to ABACUS: Path to PW calculation - Part 2">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="develop-path4.html" class="navigation navigation-next " aria-label="Next page: Introduction to ABACUS: Path to PW calculation - Part 4">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Introduction to ABACUS: Path to PW calculation - Part 3","level":"1.2.12","depth":2,"next":{"title":"Introduction to ABACUS: Path to PW calculation - Part 4","level":"1.2.13","depth":2,"path":"develop-path4.md","ref":"develop-path4.md","articles":[]},"previous":{"title":"Introduction to ABACUS: Path to PW calculation - Part 2","level":"1.2.11","depth":2,"path":"develop-path2.md","ref":"develop-path2.md","articles":[]},"dir":"ltr"},"config":{"plugins":["image-captions","auto-scroll-table","splitter","3-ba","theme-comscore","insert-logo","custom-favicon","intopic-toc","anchors","chapter-fold","expandable-chapters","-lunr","-search","search-plus","prism","-highlight","code","mathjax-pro","hide-element","tbfed-pagefooter","disqus","github-buttons","sharing-plus","-sharing","livereload"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy mcresearch.gitee.io 2023","modify_label":"该文章修订时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"page-treeview":{"copyright":"Copyright &#169; aleen42","minHeaderCount":"2","minHeaderDeep":"2"},"chapter-fold":{},"prism":{},"disqus":{"useIdentifier":false,"shortName":"abacus-user-guide"},"intopic-toc":{"isCollapsed":true,"isScrollspyActive":true,"label":"In this article","maxDepth":6,"mode":"nested","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4, .markdown-section h5, .markdown-section h6","visible":true},"livereload":{},"splitter":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"auto-scroll-table":{},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"favicon":"./picture/abacus-logo.jpg","theme-comscore":{},"page-toc-button":{"maxTocDepth":2,"minTocSize":2},"github-buttons":{"buttons":[{"user":"MCresearch","repo":"abacus-user-guide","type":"star","size":"middle","count":true}]},"custom-favicon":{},"3-ba":{"configuration":"auto","token":"25153cb8bd9a872cfec60b4b23ac0176"},"mathjax-pro":{"forceSVG":false,"version":"2.7.7"},"sharing":{"weibo":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{},"insert-logo":{"style":"background: none;max-height: 70px;width: -webkit-fill-available;max-width: 180px;","url":"./picture/abacus-logo.svg"},"expandable-chapters":{},"search-plus":{},"image-captions":{"caption":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","variable_name":"_pictures"}},"theme":"default","name":"abacus-user-guide","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"_pictures":[{"backlink":"abacus-upf.html#fig1.1.8.1","level":"1.1.8","list_caption":"Figure: 局域势函数与非局域势不同轨道角动量对应的半局域径向势函数","alt":"局域势函数与非局域势不同轨道角动量对应的半局域径向势函数","nro":1,"url":"picture/fig_upf-1.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"局域势函数与非局域势不同轨道角动量对应的半局域径向势函数","attributes":{},"skip":false,"key":"1.1.8.1"},{"backlink":"abacus-upf.html#fig1.1.8.2","level":"1.1.8","list_caption":"Figure: S赝波函数与全电子波函数对比","alt":"S赝波函数与全电子波函数对比","nro":2,"url":"picture/fig_upf-2.png","index":2,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"S赝波函数与全电子波函数对比","attributes":{},"skip":false,"key":"1.1.8.2"},{"backlink":"abacus-upf.html#fig1.1.8.3","level":"1.1.8","list_caption":"Figure: S的双投影波函数","alt":"S的双投影波函数","nro":3,"url":"picture/fig_upf-3.png","index":3,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"S的双投影波函数","attributes":{},"skip":false,"key":"1.1.8.3"},{"backlink":"abacus-upf.html#fig1.1.8.4","level":"1.1.8","list_caption":"Figure: 不同能级波函数在截断半径处log导数对比，其影响散射性质的计算","alt":"不同能级波函数在截断半径处log导数对比，其影响散射性质的计算","nro":4,"url":"picture/fig_upf-4.png","index":4,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"不同能级波函数在截断半径处log导数对比，其影响散射性质的计算","attributes":{},"skip":false,"key":"1.1.8.4"},{"backlink":"abacus-upf.html#fig1.1.8.5","level":"1.1.8","list_caption":"Figure: 不同轨道角动量对应的截断能","alt":"不同轨道角动量对应的截断能","nro":5,"url":"picture/fig_upf-5.png","index":5,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"不同轨道角动量对应的截断能","attributes":{},"skip":false,"key":"1.1.8.5"},{"backlink":"abacus-pw.html#fig1.1.12.1","level":"1.1.12","list_caption":"Figure: 电子自洽迭代计算流程。","alt":"电子自洽迭代计算流程。","nro":6,"url":"picture/fig_pw-1.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"电子自洽迭代计算流程。","attributes":{},"skip":false,"key":"1.1.12.1"},{"backlink":"abacus-pw.html#fig1.1.12.2","level":"1.1.12","list_caption":"Figure: 体系里平均单个Si原子能量(in eV/atom)随ecut (in Ry)变化。","alt":"体系里平均单个Si原子能量(in eV/atom)随ecut (in Ry)变化。","nro":7,"url":"picture/fig_pw-2.png","index":2,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"体系里平均单个Si原子能量(in eV/atom)随ecut (in Ry)变化。","attributes":{},"skip":false,"key":"1.1.12.2"},{"backlink":"abacus-pw.html#fig1.1.12.3","level":"1.1.12","list_caption":"Figure: 体系里平均单个Si原子能量(in eV/atom)随K点变化。","alt":"体系里平均单个Si原子能量(in eV/atom)随K点变化。","nro":8,"url":"picture/fig_pw-3.png","index":3,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"体系里平均单个Si原子能量(in eV/atom)随K点变化。","attributes":{},"skip":false,"key":"1.1.12.3"},{"backlink":"abacus-pw.html#fig1.1.12.4","level":"1.1.12","list_caption":"Figure: 计算时间随K点变化。","alt":"计算时间随K点变化。","nro":9,"url":"picture/fig_pw-4.png","index":4,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"计算时间随K点变化。","attributes":{},"skip":false,"key":"1.1.12.4"},{"backlink":"abacus-surface2.html#fig1.1.18.1","level":"1.1.18","list_caption":"Figure: 锯齿状势场分布图","alt":"锯齿状势场分布图","nro":10,"url":"picture/fig_surface2-1.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"锯齿状势场分布图","attributes":{},"skip":false,"key":"1.1.18.1"},{"backlink":"abacus-surface2.html#fig1.1.18.2","level":"1.1.18","list_caption":"Figure: 一个水分子位于超胞中，红色代表氧原子，白色代表氢原子","alt":"一个水分子位于超胞中，红色代表氧原子，白色代表氢原子","nro":11,"url":"picture/fig_surface2-2.png","index":2,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"一个水分子位于超胞中，红色代表氧原子，白色代表氢原子","attributes":{},"skip":false,"key":"1.1.18.2"},{"backlink":"abacus-surface2.html#fig1.1.18.3","level":"1.1.18","list_caption":"Figure: 静电势沿超胞Z轴变化图","alt":"静电势沿超胞Z轴变化图","nro":12,"url":"picture/fig_surface2-3.png","index":3,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"静电势沿超胞Z轴变化图","attributes":{},"skip":false,"key":"1.1.18.3"},{"backlink":"abacus-surface5.html#fig1.1.21.1","level":"1.1.21","list_caption":"Figure: Nanoribbon结构图，黑框代表超胞大小，有真空。超胞里包含32个碳原子（棕色），超胞里接触真空的2个碳原子（每个表面一个碳原子）被2个氢原子（白色）饱和。","alt":"Nanoribbon结构图，黑框代表超胞大小，有真空。超胞里包含32个碳原子（棕色），超胞里接触真空的2个碳原子（每个表面一个碳原子）被2个氢原子（白色）饱和。","nro":13,"url":"picture/fig_surface5-1.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"Nanoribbon结构图，黑框代表超胞大小，有真空。超胞里包含32个碳原子（棕色），超胞里接触真空的2个碳原子（每个表面一个碳原子）被2个氢原子（白色）饱和。","attributes":{},"skip":false,"key":"1.1.21.1"},{"backlink":"abacus-surface5.html#fig1.1.21.2","level":"1.1.21","list_caption":"Figure: 锯齿状势场分布图","alt":"锯齿状势场分布图","nro":14,"url":"picture/fig_surface2-1.png","index":2,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"锯齿状势场分布图","attributes":{},"skip":false,"key":"1.1.21.2"},{"backlink":"abacus-surface5.html#fig1.1.21.3","level":"1.1.21","list_caption":"Figure: 采用PBE交换关联泛函和非自旋极化得到的二维nanoribbon的能带图，可以看出费米面附近CBM（Conduction Band Minimum）和VBM（Valence Band Maximum）重合，无带隙。","alt":"采用PBE交换关联泛函和非自旋极化得到的二维nanoribbon的能带图，可以看出费米面附近CBM（Conduction Band Minimum）和VBM（Valence Band Maximum）重合，无带隙。","nro":15,"url":"picture/fig_surface5-3.png","index":3,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"采用PBE交换关联泛函和非自旋极化得到的二维nanoribbon的能带图，可以看出费米面附近CBM（Conduction Band Minimum）和VBM（Valence Band Maximum）重合，无带隙。","attributes":{},"skip":false,"key":"1.1.21.3"},{"backlink":"abacus-surface5.html#fig1.1.21.4","level":"1.1.21","list_caption":"Figure: 采用PBE交换关联泛函和自旋极化得到的二维nanoribbon的能带图。蓝色和红色代表自旋极化方向不同时对应的两副能带图像，可以看出不加电场时，两个自旋方向的能带图几乎一样，都有带隙。","alt":"采用PBE交换关联泛函和自旋极化得到的二维nanoribbon的能带图。蓝色和红色代表自旋极化方向不同时对应的两副能带图像，可以看出不加电场时，两个自旋方向的能带图几乎一样，都有带隙。","nro":16,"url":"picture/fig_surface5-4.png","index":4,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"采用PBE交换关联泛函和自旋极化得到的二维nanoribbon的能带图。蓝色和红色代表自旋极化方向不同时对应的两副能带图像，可以看出不加电场时，两个自旋方向的能带图几乎一样，都有带隙。","attributes":{},"skip":false,"key":"1.1.21.4"},{"backlink":"abacus-surface5.html#fig1.1.21.5","level":"1.1.21","list_caption":"Figure: 采用PBE交换关联泛函和自旋极化，再给体系加上0.1 V/Å的电场得到的二维nanoribbon的能带图。蓝色和红色代表自旋极化方向不同时对应的两副能带图像，可以看出加了能带之后，其中一个自旋方向的能带图出现费米面附近的交叠，呈现金属性质，另外一个自旋方向的能带图依旧保持在费米面处的能隙。","alt":"采用PBE交换关联泛函和自旋极化，再给体系加上0.1 V/Å的电场得到的二维nanoribbon的能带图。蓝色和红色代表自旋极化方向不同时对应的两副能带图像，可以看出加了能带之后，其中一个自旋方向的能带图出现费米面附近的交叠，呈现金属性质，另外一个自旋方向的能带图依旧保持在费米面处的能隙。","nro":17,"url":"picture/fig_surface5-5.png","index":5,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"采用PBE交换关联泛函和自旋极化，再给体系加上0.1 V/Å的电场得到的二维nanoribbon的能带图。蓝色和红色代表自旋极化方向不同时对应的两副能带图像，可以看出加了能带之后，其中一个自旋方向的能带图出现费米面附近的交叠，呈现金属性质，另外一个自旋方向的能带图依旧保持在费米面处的能隙。","attributes":{},"skip":false,"key":"1.1.21.5"},{"backlink":"abacus-surface6.html#fig1.1.22.1","level":"1.1.22","list_caption":"Figure: 一个水分子位于超胞中，红色代表氧原子，白色代表氢原子","alt":"一个水分子位于超胞中，红色代表氧原子，白色代表氢原子","nro":18,"url":"picture/fig_surface6-1.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"一个水分子位于超胞中，红色代表氧原子，白色代表氢原子","attributes":{},"skip":false,"key":"1.1.22.1"},{"backlink":"abacus-surface6.html#fig1.1.22.2","level":"1.1.22","list_caption":"Figure: 静电势（Electrostatic Potential）沿超胞Z轴变化图","alt":"静电势（Electrostatic Potential）沿超胞Z轴变化图","nro":19,"url":"picture/fig_surface6-2.png","index":2,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"静电势（Electrostatic Potential）沿超胞Z轴变化图","attributes":{},"skip":false,"key":"1.1.22.2"},{"backlink":"abacus-dos.html#fig1.1.23.1","level":"1.1.23","list_caption":"Figure: 铁的态密度（DOS），红线表示自旋向下电子的能带图，黑线表示自旋向上电子的能带图。费米面设为 0 点，即蓝色虚线所在能量位置。可以看出铁的两个自旋方向态密度并不相等，因此铁具有磁性。","alt":"铁的态密度（DOS），红线表示自旋向下电子的能带图，黑线表示自旋向上电子的能带图。费米面设为 0 点，即蓝色虚线所在能量位置。可以看出铁的两个自旋方向态密度并不相等，因此铁具有磁性。","nro":20,"url":"picture/fig_dos-5.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"铁的态密度（DOS），红线表示自旋向下电子的能带图，黑线表示自旋向上电子的能带图。费米面设为 0 点，即蓝色虚线所在能量位置。可以看出铁的两个自旋方向态密度并不相等，因此铁具有磁性。","attributes":{},"skip":false,"key":"1.1.23.1"},{"backlink":"abacus-dos.html#fig1.1.23.2","level":"1.1.23","list_caption":"Figure: 铁的能带图，红线表示自旋向下电子的能带图，黑线表示自旋向上电子的能带图。费米面设为 0 点。","alt":"铁的能带图，红线表示自旋向下电子的能带图，黑线表示自旋向上电子的能带图。费米面设为 0 点。","nro":21,"url":"picture/fig_dos-6.png","index":2,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"铁的能带图，红线表示自旋向下电子的能带图，黑线表示自旋向上电子的能带图。费米面设为 0 点。","attributes":{},"skip":false,"key":"1.1.23.2"},{"backlink":"develop-path4.html#fig1.2.13.1","level":"1.2.13","list_caption":"Figure: PW_Basis::distribute_r()：设一个pool中有5个processors","alt":"PW_Basis::distribute_r()：设一个pool中有5个processors","nro":22,"url":"picture/fig_path4-2.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"PW_Basis::distribute_r()：设一个pool中有5个processors","attributes":{},"skip":false,"key":"1.2.13.1"},{"backlink":"develop-path4.html#fig1.2.13.2","level":"1.2.13","list_caption":"Figure: this->count_pw_st(st_length2D, st_bottom2D)","alt":"this->count_pw_st(st_length2D, st_bottom2D)","nro":23,"url":"picture/fig_path4-3.png","index":2,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"this->count_pw_st(st_length2D, st_bottom2D)","attributes":{},"skip":false,"key":"1.2.13.2"},{"backlink":"develop-path5.html#fig1.2.14.1","level":"1.2.14","list_caption":"Figure: 善用Ctrl+F","alt":"善用Ctrl+F","nro":24,"url":"picture/fig_path5-9.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"善用Ctrl+F","attributes":{},"skip":false,"key":"1.2.14.1"},{"backlink":"develop-path5.html#fig1.2.14.2","level":"1.2.14","list_caption":"Figure: klist.cpp line 486: K_Vectors::Monkhorst_Pack_formula(), k_type = 0 and 1","alt":"klist.cpp line 486: K_Vectors::Monkhorst_Pack_formula(), k_type = 0 and 1","nro":25,"url":"picture/fig_path5-10.png","index":2,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"klist.cpp line 486: K_Vectors::Monkhorst_Pack_formula(), k_type = 0 and 1","attributes":{},"skip":false,"key":"1.2.14.2"},{"backlink":"develop-path5.html#fig1.2.14.3","level":"1.2.14","list_caption":"Figure: klist.cpp line 520: const int i = mpnx * mpny * (z - 1) + mpnx * (y - 1) + (x - 1)","alt":"klist.cpp line 520: const int i = mpnx * mpny * (z - 1) + mpnx * (y - 1) + (x - 1)","nro":26,"url":"picture/fig_path5-11.png","index":3,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"klist.cpp line 520: const int i = mpnx * mpny * (z - 1) + mpnx * (y - 1) + (x - 1)","attributes":{},"skip":false,"key":"1.2.14.3"},{"backlink":"develop-path5.html#fig1.2.14.4","level":"1.2.14","list_caption":"Figure: 1-dimensional example","alt":"1-dimensional example","nro":27,"url":"picture/fig_path5-12.png","index":4,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"1-dimensional example","attributes":{},"skip":false,"key":"1.2.14.4"},{"backlink":"develop-path5.html#fig1.2.14.5","level":"1.2.14","list_caption":"Figure: 2-dimensional example","alt":"2-dimensional example","nro":28,"url":"picture/fig_path5-13.png","index":5,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"2-dimensional example","attributes":{},"skip":false,"key":"1.2.14.5"},{"backlink":"develop-path6.html#fig1.2.16.1","level":"1.2.16","list_caption":"Figure: update cutoff value based on factorized nx, ny and nz","alt":"update cutoff value based on factorized nx, ny and nz","nro":29,"url":"picture/fig_path6-1.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"update cutoff value based on factorized nx, ny and nz","attributes":{},"skip":false,"key":"1.2.16.1"},{"backlink":"develop-path10.html#fig1.2.20.1","level":"1.2.20","list_caption":"Figure: parallelization over kpoints","alt":"parallelization over kpoints","nro":30,"url":"picture/fig_path10-3.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"parallelization over kpoints","attributes":{},"skip":false,"key":"1.2.20.1"},{"backlink":"develop-path10.html#fig1.2.20.2","level":"1.2.20","list_caption":"Figure: parts on which we are concentrated now","alt":"parts on which we are concentrated now","nro":31,"url":"picture/fig_path10-4.png","index":2,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"parts on which we are concentrated now","attributes":{},"skip":false,"key":"1.2.20.2"},{"backlink":"develop-path10.html#fig1.2.20.3","level":"1.2.20","list_caption":"Figure: PW和LCAO的代码设计平行关系与调用","alt":"PW和LCAO的代码设计平行关系与调用","nro":32,"url":"picture/fig_path10-5.png","index":3,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"PW和LCAO的代码设计平行关系与调用","attributes":{},"skip":false,"key":"1.2.20.3"},{"backlink":"develop-path10.html#fig1.2.20.4","level":"1.2.20","list_caption":"Figure: Relationship between variables that matter presently","alt":"Relationship between variables that matter presently","nro":33,"url":"picture/fig_path10-6.png","index":4,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"Relationship between variables that matter presently","attributes":{},"skip":false,"key":"1.2.20.4"},{"backlink":"develop-path10.html#fig1.2.20.5","level":"1.2.20","list_caption":"Figure: Higher resolution framework of diag_mock() and relationship with other modules and functions","alt":"Higher resolution framework of diag_mock() and relationship with other modules and functions","nro":34,"url":"picture/fig_path10-9.png","index":5,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"Higher resolution framework of diag_mock() and relationship with other modules and functions","attributes":{},"skip":false,"key":"1.2.20.5"},{"backlink":"develop-path11.html#fig1.2.21.1","level":"1.2.21","list_caption":"Figure: mixing方法的通用框架设计","alt":"mixing方法的通用框架设计","nro":35,"url":"picture/fig_path11-3.png","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"mixing方法的通用框架设计","attributes":{},"skip":false,"key":"1.2.21.1"},{"backlink":"algorithm-wannier.html#fig1.3.1.1","level":"1.3.1","list_caption":"Figure: 左列：不同k点对应的布洛赫波函数；右列：不同晶格中的Wannier函数。","alt":"左列：不同k点对应的布洛赫波函数；右列：不同晶格中的Wannier函数。","nro":36,"url":"picture/fig_wannier.jpg","index":1,"caption_template":"图 _PAGE_IMAGE_NUMBER_. _CAPTION_","label":"左列：不同k点对应的布洛赫波函数；右列：不同晶格中的Wannier函数。","attributes":{},"skip":false,"key":"1.3.1.1"}]},"gitbook":"*","description":"国产DFT开源软件ABACUS中文使用教程"},"file":{"path":"develop-path3.md","mtime":"2023-10-04T15:11:45.401Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-07-07T11:04:31.198Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-3-ba/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-insert-logo/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-intopic-toc/anchor.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-intopic-toc/gumshoe.polyfills.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-intopic-toc/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-mathjax-pro/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

